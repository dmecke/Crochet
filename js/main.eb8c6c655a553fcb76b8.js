(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{0:function(e,t){},1:function(e,t){},10:function(e,t){},11:function(e,t){},12:function(e,t){},13:function(e,t){},14:function(e,t){},15:function(e,t){},16:function(e,t){},2:function(e,t){},"2Qx2":function(e,t,i){"use strict";(function(e,o){i.d(t,"a",(function(){return l}));var n=i("W2Rx"),s=i("oj90");const r=i("33yf"),a=i("Iab2"),l={editingPath:e.observable(null),editingName:e.observable("NewFile"),editingType:e.observable("yarn"),editingFolder:e.observable(null),isDocumentDirty:e.observable(!1),fileVersion:1,restoreFromLocalStorage:e.observable(!0),lastStorageHost:e.observable("LOCAL"),editingFileFolder:function(e=""){const t=l.editingPath()?l.editingPath():"";return e.length>0?r.join(r.dirname(t),e):r.dirname(t)},startNewFile:function(e="NewFile",t="yarn"){l.editingPath(null),l.editingName(e),l.editingType(t),l.editingFolder(null),app.workspace.selectedNodes=[],app.editing(null),app.nodes([app.newNode(!0).title("Start")]),app.tags([]),app.updateNodeLinks(),app.workspace.warpToNodeByIdx(0),l.lastStorageHost("LOCAL"),l.isDocumentDirty(!0),app.refreshWindowTitle(),l.clearFileTags()},askForFileName:function(){Swal.fire({title:"Enter a New File Name",input:"text",inputPlaceholder:"NewFile",showCancelButton:!0}).then(e=>{(e.value||""===e.value)&&l.startNewFile(e.value||"NewFile")})},setNewFile:function(){Swal.fire({title:"Create a New File?",text:`Any unsaved progress to ${l.editingName()} will be lost!`,icon:"warning",showCancelButton:!0,confirmButtonText:"New file",cancelButtonText:"No, cancel!"}).then(e=>{e.value&&l.askForFileName()})},saveAppStateToLocalStorage:function(){if(!l.restoreFromLocalStorage())return;const e=app.settings.storage;l.isDocumentDirty(!0),app.refreshWindowTitle(),e.setItem("appState",JSON.stringify({editingPath:l.editingPath(),editingName:l.editingName(),editingType:l.editingType(),editingFolder:l.editingFolder(),editingTitle:app.editing()?app.editing().title():null,fileTags:app.fileTags,nodes:l.getNodesAsObjects(),tags:app.tags(),editorSelection:app.editor?app.editor.selection.getRange():null,transform:app.workspace.transform,scale:app.workspace.scale,lastStorageHost:l.lastStorageHost()}))},loadAppStateFromLocalStorage:function(){if(!l.restoreFromLocalStorage())return;console.log("RESTORING APP FROM LOCAL STORAGE");const e=app.settings.storage,t=JSON.parse(e.getItem("appState"));if(t){const{editingPath:e,lastStorageHost:i,editingName:o,editingType:n,editingFolder:s,editingTitle:r,editorSelection:a,fileTags:d,nodes:c,tags:u,transform:p,scale:g}=t;l.editingPath(e),l.editingName(o),l.editingType(n),l.editingFolder(s),l.lastStorageHost(i),app.fileTags=d,app.nodes([]),l.getNodesFromObjects(c).forEach(e=>app.nodes.push(e)),app.tags(u),app.updateNodeLinks(),app.workspace.setTranslation(p.x,p.y),app.workspace.setZoom(4*g),r&&(app.editNode(app.nodes().find(e=>e.title()===r)),a&&app.editor.selection.setRange(a)),l.isDocumentDirty(!0),app.refreshWindowTitle()}},readFile:function(e,t,i){var o=new FileReader;o.onload=function(n){var r=l.getFileType(t);r==s.FILETYPE.UNKNOWN?Swal.fire({title:"Unknown filetype!",icon:"error"}):(l.editingPath(e.path),l.editingType(r),l.loadData(o.result,r,i))},o.readAsText(e)},setNewFileStats:function(e,t,i="LOCAL"){l.editingName(e.replace(/^.*[\\\/]/,"")),l.isDocumentDirty(!1),l.editingPath(t),l.lastStorageHost(i),app.refreshWindowTitle()},openFile:function(e,t){const i=l.editingPath()?"Any unsaved progress to "+l.editingName()+" will be lost.":"Any unsaved progress will be lost.";Swal.fire({title:"Are you sure you want to open another file?",text:i,icon:"warning",showConfirmButton:!0,showCancelButton:!0}).then(i=>{!0===i.value&&(null!==app.editing()&&app.closeEditor(),l.clearFileTags(),l.readFile(e,t,!0),l.setNewFileStats(t,e.path),app.refreshWindowTitle())})},openFileFromFilePath:function(e){const t=app.path.basename(e);o.ajax({url:e,async:!1,success:i=>{const o=l.getFileType(t);o==s.FILETYPE.UNKNOWN?Swal.fire({title:"Unknown filetype!",icon:"error"}):(l.loadData(i,o,!0),l.setNewFileStats(t,e))}})},openFiles:function(e,t){const i=document.getElementById("open-file").files;Object.entries(i).forEach(([e,t])=>{"0"===e?l.openFile(t,t.name):l.appendFile(t,t.name)})},openFolder:function(e,t){editingFolder=t,Swal.fire({text:"openFolder not yet implemented e: "+e+" foldername: "+t,icon:"error"})},appendFile:function(e,t){l.readFile(e,t,!1)},getFileType:function(e){const t=e.toLowerCase();return t.endsWith(".json")?s.FILETYPE.JSON:t.endsWith(".yarn.txt")||t.endsWith(".yarn")?s.FILETYPE.YARN:t.endsWith(".xml")?s.FILETYPE.XML:t.endsWith(".txt")?s.FILETYPE.TWEE:t.endsWith(".tw2")||t.endsWith(".twee")?s.FILETYPE.TWEE2:s.FILETYPE.UNKNOWN},loadData:function(e,t,i){const n=[];if(t==s.FILETYPE.JSON){if(!(e=JSON.parse(e)))return;for(let t=0;t<e.length;t++)n.push(e[t])}else if(t==s.FILETYPE.YARN){var r=e.split(/\r?\n/),a={},d=[],c=0,u=!1,p=!1,g=!1;for(let e=0;e<r.length;e++)if("#"===r[e].trim().charAt(0))r[e].trim().includes("#__PrivCrochet_version:"+l.fileVersion)?p=!0:app.fileTags.push(r[e].slice(1));else if(u){for(a.position||(a.position={x:0,y:0}),!1===g&&d.length>0?(a.tags="",d.forEach(e=>{a.tags+=e+" "}),a.tags=a.tags.trim()):g&&d.length>a.tags.split(" ").length&&d.forEach(e=>{a.tags+=" ",!1===a.tags.includes(e)&&(a.tags+=e+" "),a.tags=a.tags.trim()}),g=!1,d=[];e<r.length&&"==="!==r[e];)a.body+=r[e]+"\n",e++;u=!1,o.isEmptyObject(a)||(n.push(a),a={})}else if(r[e].includes("title:"))a.title=r[e].substr(6).trim();else if("---"==r[e].trim())u=!0,a.body="";else if(!1===p&&r[e].includes("tags:"))a.tags=r[e].substr(5).trim();else{let t=p?"__PrivCrochet_position:":"position:",i=p?"__PrivCrochet_colorID:":"colorID:";if(r[e].includes(t)){var h=r[e].substr(t.length+1).trim().split(",");a.position={x:Number(h[0].trim()),y:Number(h[1].trim())}}else r[e].includes(i)?a.colorID=Number(r[e].substr(i.length).trim()):r[e].includes("__PrivCrochet_tags:")?(a.tags=r[e].substr(19).trim(),g=!0):d.push(r[e])}}else if(t==s.FILETYPE.TWEE||t==s.FILETYPE.TWEE2){r=e.split("\n"),a=null,c=0;for(var f=0;f<r.length;f++)if(r[f]=r[f].trim(),"::"==r[f].substr(0,2)){null!=a&&n.push(a),a={};var m="",y=(d="",{x:80*++c,y:80*c}),v=r[f].indexOf("["),w=r[f].indexOf("]");v>0&&w>0&&(d=r[f].substr(v+1,w-v-1));var b=r[f].indexOf("<"),x=r[f].indexOf(">");if(b>0&&x>0){var T=r[f].substr(b+1,x-b-1).split(",");y.x=parseInt(T[0]),y.y=parseInt(T[1])}var S=0;v>0?S=v:b>0&&(S=b),m=(m=S?r[f].substr(3,S-3):r[f].substr(3)).trim(),a.title=m,a.tags=d,a.body="",a.position=y}else null!=a&&(a.body.length>0&&(r[f]+="\n"),a.body+=r[f]);null!=a&&n.push(a)}else if(t==s.FILETYPE.XML){var C=(new DOMParser).parseFromString(e,"text/xml");if(null!=(e=s.Utils.xmlToObject(C)))for(let t=0;t<e.length;t++)n.push(e[t])}i&&app.nodes.removeAll(),l.getNodesFromObjects(n).forEach(e=>app.nodes.push(e)),app.updateNodeLinks(),app.updateTagsRepository(),app.workspace.warpToNodeByIdx(0)},saveFileTags:function(e){e.split(/\r?\n/).forEach(e=>{let t=e.slice(1);app.fileTags.push(t)}),l.trySaveCurrent()},clearFileTags:function(){app.fileTags=[]},getNodeFromObject:function(e){return new n.a({title:e.title,body:e.body,tags:e.tags,colorID:e.colorID,x:Number(e.position.x),y:Number(e.position.y)})},getNodesFromObjects:function(e){const t=[];return e?(e.forEach(e=>{t.push(l.getNodeFromObject(e))}),t):[]},getNodeAsObject:function(e){return{title:e.title(),tags:e.tags(),body:e.body(),position:{x:e.x(),y:e.y()},colorID:e.colorID()}},getNodesAsObjects:function(){const e=[],t=app.nodes();for(var i=0;i<t.length;i++)e.push(l.getNodeAsObject(t[i]));return e},getSaveData:function(e){var t="",i=l.getNodesAsObjects();if(e==s.FILETYPE.JSON)t=JSON.stringify(i,null,"\t");else if(e==s.FILETYPE.YARN){t+="#__PrivCrochet_version:"+l.fileVersion+"\n",app.fileTags.forEach(e=>{t+="#"+e+"\n"});for(let e=0;e<i.length;e++){t+="__PrivCrochet_colorID: "+i[e].colorID+"\n",t+="__PrivCrochet_position: "+i[e].position.x+","+i[e].position.y+"\n",t+="__PrivCrochet_tags: "+i[e].tags+"\n",i[e].tags.split(" ").forEach(e=>{""!==e&&(RegExp("[:]").test(e)?t+=e+"\n":t+=e+":\n")}),t+="title: "+i[e].title+"\n",t+="---\n",t+=i[e].body;var o=i[e].body;o.length>0&&"\n"==o[o.length-1]||(t+="\n"),t+="===\n"}}else if(e==s.FILETYPE.TWEE)for(let e=0;e<i.length;e++){var n="";i[e].tags.length>0&&(n=" ["+i[e].tags+"]"),t+=":: "+i[e].title+n+"\n",t+=i[e].body+"\n\n"}else if(e==s.FILETYPE.TWEE2)for(let e=0;e<i.length;e++){n="";i[e].tags.length>0&&(n=" ["+i[e].tags+"]");var r=" <"+i[e].position.x+","+i[e].position.y+">";t+=":: "+i[e].title+n+r+"\n",t+=i[e].body+"\n\n"}else if(e==s.FILETYPE.XML){t+="<nodes>\n";for(let e=0;e<i.length;e++)t+="\t<node>\n",t+="\t\t<title>"+i[e].title+"</title>\n",t+="\t\t<tags>"+i[e].tags+"</tags>\n",t+="\t\t<body>"+i[e].body+"</body>\n",t+='\t\t<position x="'+i[e].position.x+'" y="'+i[e].position.y+'"></position>\n',t+="\t\t<colorID>"+i[e].colorID+"</colorID>\n",t+="\t</node>\n";t+="</nodes>\n"}return l.isDocumentDirty(!1),app.refreshWindowTitle(),t},saveTo:function(e,t,i=null){null!=app.fs&&app.fs.writeFile(e,t,{encoding:"utf-8"},(function(t){l.editingPath(e),i&&i(),t?Swal.fire({title:"Error Saving Data to "+e+": "+t,icon:"error"}):app.ui.notification.fire({title:"Saved!",icon:"success"})}))},openFileDialog:function(e,t){e.bind("change",(function(i){t(i.currentTarget.files[0],e.val());var o="";null!=e.attr("nwsaveas")&&(o='nwsaveas="'+e.attr("nwsaveas")+'"'),null!=e.attr("accept")&&(o='accept="'+e.attr("accept")+'"'),e.parent().append('<input type="file" id="'+e.attr("id")+'"  '+o+">"),e.unbind("change"),e.remove()})),e.trigger("click")},saveFileDialog:function(e,t,i){var o=new Blob([i],{type:"text/plain;charset=utf-8"});a(o,(l.editingName()||"").replace(/\.[^/.]+$/,"")+"."+t)},insertImageFileName:function(){l.openFileDialog(o("#open-image"),(function(e,t){app.insertTextAtCursor(e.path?e.path:e.name)}))},tryOpenFile:function(){l.openFileDialog(o("#open-file"),l.openFiles)},promptFileNameAndFormat:function(e,t=null){Swal.fire({title:"💾 Save file - enter file name",html:`<input id="swal-input1" list="select-file-name" name="select" placeholder="${l.editingName()}">\n      <datalist class="form-control" id="select-file-name">    \n        ${t&&t.map(e=>`<option value="${e}" />`).join("")}\n      </datalist>`,onOpen:()=>{"NewFile"!==l.editingName()&&(document.getElementById("swal-input1").value=l.editingName())},showCancelButton:!0,preConfirm:()=>document.getElementById("swal-input1").value}).then(({value:t})=>{if(t&&""!==t){l.editingName(t);const i=l.editingType(),o=(l.editingName()||"").replace(/\.[^/.]+$/,"")+"."+i,n=l.getSaveData(i);e({editingName:o,yarnData:n})}})},tryShareFilePwa:function(e){l.promptFileNameAndFormat(({editingName:e,yarnData:t})=>{const i=[new Blob([t],{type:"text/plain"})],o=new File(i,e,{});navigator.canShare&&navigator.canShare({files:[o]})?navigator.share({title:e,text:t,file:[o]}).then(()=>console.log("Successful share")).catch(e=>console.log("Error sharing",e)):Swal.fire({title:"Web Share API is not supported in your browser.\nTry using it on your smartphone or tablet...",icon:"error"})})},trySaveGist:function(e){e&&e.file&&e.file.length>0?e.get(e.file).then(t=>{const i=Object.keys(t.body.files);console.log(i),l.promptFileNameAndFormat(({editingName:t,yarnData:i})=>{e.edit(e.file,{files:{[t]:{content:i}}}),Swal.fire("Saved!","The Yarn has been saved to gist "+e.file,"success"),l.lastStorageHost("GIST"),l.isDocumentDirty(!1),app.refreshWindowTitle()},i)}):(Swal.fire("Not configured","Your github settings are not configured","warning"),app.ui.openSettingsDialog())},tryOpenGist:function(e){e&&e.file&&e.file.length>0?e.get(e.file).then(e=>{const t=e.body.files,i={};Object.keys(t).forEach(e=>{i[e]=e}),Swal.fire({title:"🐙 Open file from a gist",input:"select",inputOptions:i,inputAttributes:{autocomplete:"off"},inputPlaceholder:"Select a file from the gist",showCancelButton:!0}).then(({value:e})=>{if(e){const i=t[e].content,o=l.getFileType(e);l.loadData(i,o,!0),l.isDocumentDirty(!1),l.lastStorageHost("GIST"),l.editingPath(null),l.editingName(e),app.refreshWindowTitle()}})}):(Swal.fire("Not configured","Your github settings are not configured","warning"),app.ui.openSettingsDialog())},tryOpenFolder:function(){l.openFileDialog(o("#open-folder"),l.openFolder)},tryAppend:function(){l.openFileDialog(o("#open-file"),l.appendFile)},save:function(){app.editingVisualStudioCodeFile()||(l.editingPath()?l.trySaveCurrent():l.trySave(s.FILETYPE.JSON))},trySave:function(e){l.editingType(e),l.saveFileDialog(o("#save-file"),e,l.getSaveData(e))},trySaveCurrent:function(){if("GIST"===l.lastStorageHost()){const e=app.gists;e.get(e.file).then(t=>{const i=l.getSaveData(l.editingType());e.edit(e.file,{files:{[l.editingName()]:{content:i}}}),l.lastStorageHost("GIST"),l.isDocumentDirty(!1),app.refreshWindowTitle()})}else l.editingPath()?l.editingPath().length>0&&l.editingType().length>0&&l.saveTo(l.editingPath(),l.getSaveData(l.editingType())):(l.saveAppStateToLocalStorage(),Swal.fire({title:"Saved to Internal Storage Only!",text:"Please export the file and re-open it to ensure changes are saved to your disk. If you don't, internal storage will be overwritten when you open another file and your changes will be lost.",icon:"info"}))},doesFileExist:function(e){return!1},triggerPasteClipboard:function(){if(app.electron){const e=app.electron.clipboard.readText();app.clipboard=e,document.execCommand("paste")}else navigator.clipboard&&navigator.clipboard.readText().then(e=>{app.clipboard=e}).catch(e=>{app.clipboard=app.editor.getSelectedText(),console.log("No clipboard access",e,"using local instead")}),setTimeout(()=>app.insertTextAtCursor(app.clipboard),100)},triggerCopyClipboard:function(){if(app.electron)app.electron.clipboard.writeText(app.editor.getSelectedText()),app.clipboard=app.editor.getSelectedText();else{const e=app.editor.getSelectedText();app.clipboard=e,navigator.clipboard&&e.length>0&&navigator.clipboard.writeText(e).then(()=>{app.clipboard=e})}}}}).call(this,i("kzO7"),i("EVdn"))},3:function(e,t){},4:function(e,t){},5:function(e,t){},"5dEm":function(e,t,i){"use strict";(function(e){i.d(t,"a",(function(){return n}));var o=i("oj90");const n=function(t){const i=this,n={toast:!0,position:"bottom",icon:"error",title:"Alignment requires two or more nodes be selected.",showConfirmButton:!1,timer:3500,timerProgressBar:!0};this.canvas=e(".arrows")[0],this.context=i.canvas.getContext("2d"),this.gridCanvas=e("#grid-canvas")[0],this.gridContext=i.gridCanvas.getContext("2d"),this.gridEnabled=!0,this.updateArrowsThrottle=50,this.updateArrowsInterval=void 0,this.deferredArrowsDrawInterval=void 0,this.nextArrowsUpdate=Number.NEGATIVE_INFINITY,this.isDrawingArrows=!1,this.selectedNodes=[],this.scale=1,this.offset={x:0,y:0},this.transform={x:0,y:0},this.isMarqueeEnabled=!1,this.marqueeSelection=[],this.marqueeRect={x1:0,y1:0,x2:0,y2:0},this.marqueeOffset=[0,0],this.zoomSpeed=.005,this.zoomLimitMin=.05,this.zoomLimitMax=1,this.setThrottle=function(e,t){const n=t?t.target.value:e;i.updateArrowsThrottle=o.Utils.clamp(n,16,250)},this.setTranslation=function(e,t,o=0){i.transform.x=e,i.transform.y=t,i.translate(o)},this.shiftTranslation=function(e,t,o=0){i.setTranslation(i.transform.x+e,i.transform.y+t,o)},this.translate=function(t){t&&i.startUpdatingArrows(),e(".nodes-holder").finish().transition({transform:"matrix("+i.scale+",0,0,"+i.scale+","+i.transform.x+","+i.transform.y+")"},t||0,"easeInQuad",(function(){t&&i.stopUpdatingArrows(),i.updateArrows(),i.updateGrid()}))},this.toWorkspaceCoordinates=(e,o)=>t.settings.snapGridEnabled()?{x:i.stepify((e-i.transform.x)/i.scale,t.settings.gridSize()),y:i.stepify((o-i.transform.y)/i.scale,t.settings.gridSize())}:{x:(e-i.transform.x)/i.scale,y:(o-i.transform.y)/i.scale},this.onPanLeft=function(){i.shiftTranslation(i.getPanAmount(),0,100)},this.onPanRight=function(){i.shiftTranslation(-i.getPanAmount(),0,100)},this.onPanUp=function(){i.shiftTranslation(0,i.getPanAmount(),100)},this.onPanDown=function(){i.shiftTranslation(0,-i.getPanAmount(),100)},this.getPanAmount=function(){return t.input.isShiftDown?100*i.scale:500*i.scale},this.setZoom=function(e){i.scale=e/4,i.translate(200)},this.onZoom=function(e,t,n){const s=i.scale,r=n*i.zoomSpeed*i.scale;i.scale=o.Utils.clamp(i.scale+r,i.zoomLimitMin,i.zoomLimitMax);const a=e-i.transform.x,l=t-i.transform.y,d=a-a*(i.scale/s),c=l-l*(i.scale/s);i.shiftTranslation(d,c)},this.onDragStart=function(e){i.offset.x=e.x,i.offset.y=e.y},this.onDragUpdate=function(e){i.isMarqueeEnabled&&t.workspace.onMarqueeEnd(),t.workspace.shiftNodes(e)},this.onDragEnd=function(){t.data.saveAppStateToLocalStorage()},this.onMarqueeStart=function(e){i.isMarqueeEnabled=!0,i.offset.x=e.x,i.offset.y=e.y,i.marqueeSelection=[],i.marqueeOffset[0]=0,i.marqueeOffset[1]=0,i.marqueeRect={x1:0,y1:0,x2:0,y2:0}},this.onMarqueeUpdate=function(e){i.isMarqueeEnabled&&(i.updateMarqueeRect(e),i.selectNodesInsideMarquee())},this.updateMarqueeRect=function(t){t.x>i.offset.x&&t.y<i.offset.y?(i.marqueeRect.x1=i.offset.x,i.marqueeRect.y1=t.y,i.marqueeRect.x2=t.x,i.marqueeRect.y2=i.offset.y):t.x>i.offset.x&&t.y>i.offset.y?(i.marqueeRect.x1=i.offset.x,i.marqueeRect.y1=i.offset.y,i.marqueeRect.x2=t.x,i.marqueeRect.y2=t.y):t.x<i.offset.x&&t.y<i.offset.y?(i.marqueeRect.x1=t.x,i.marqueeRect.y1=t.y,i.marqueeRect.x2=i.offset.x,i.marqueeRect.y2=i.offset.y):(i.marqueeRect.x1=t.x,i.marqueeRect.y1=i.offset.y,i.marqueeRect.x2=i.offset.x,i.marqueeRect.y2=t.y),e("#marquee").css({display:"block",x:i.marqueeRect.x1,y:i.marqueeRect.y1,width:Math.abs(i.marqueeRect.x1-i.marqueeRect.x2),height:Math.abs(i.marqueeRect.y1-i.marqueeRect.y2)})},this.selectNodesInsideMarquee=function(){const e=i.toWorkspaceCoordinates(i.marqueeRect.x1,i.marqueeRect.y1),n=i.toWorkspaceCoordinates(i.marqueeRect.x2,i.marqueeRect.y2),s={left:e.x,right:n.x,top:e.y,bottom:n.y};t.nodes().forEach(e=>{const t=i.marqueeSelection.indexOf(e),n=t>=0,r=e.x(),a=e.y(),l={left:r,right:r+e.width,top:a,bottom:a+e.height},d=o.Utils.rectanglesOverlap(s,l);d&&!n&&(i.selectNodes(e),i.marqueeSelection.push(e)),!d&&n&&(i.deselectNodes(e),i.marqueeSelection.splice(t,1))})},this.onMarqueeEnd=function(){i.isMarqueeEnabled&&(0==i.marqueeSelection.length&&i.deselectAll(),i.isMarqueeEnabled=!1,i.marqueeSelection=[],i.marqueeRect={x1:0,y1:0,x2:0,y2:0},e("#marquee").css({display:"none",x:0,y:0,width:0,height:0}))},this.shiftNodes=function(e){const t={x:e.x-i.offset.x,y:e.y-i.offset.y};i.shiftTranslation(t.x,t.y),i.offset=e},this.updateGrid=function(){const o=e(".nodes-holder").offset(),n=t.settings.gridSize();if(i.gridContext.clearRect(0,0,i.gridCanvas.width,i.gridCanvas.height),t.settings.snapGridEnabled()){const a=e(window).width(),l=e(window).height(),d=o.left%(n*i.scale),c=o.top%(n*i.scale);i.gridContext.beginPath(),i.gridContext.lineWidth=.5;for(var s=d;s<a;s+=n*i.scale)i.gridContext.moveTo(s,0),i.gridContext.lineTo(s,l);for(var r=c;r<l;r+=n*i.scale)i.gridContext.moveTo(0,r),i.gridContext.lineTo(a,r);if(i.gridContext.stroke(),i.gridContext.closePath(),"blueprint"===t.settings.theme()){i.gridContext.beginPath(),i.gridContext.lineWidth=.25;const e=16,t=200,d=Math.round(Math.min(1,n/t)*e),c=Math.max(1,Math.round(i.scale*d)),u=n*i.scale/c,p=o.left%u,g=o.top%u;for(s=p;s<a;s+=u)i.gridContext.moveTo(s,0),i.gridContext.lineTo(s,l);for(r=g;r<l;r+=u)i.gridContext.moveTo(0,r),i.gridContext.lineTo(a,r);i.gridContext.stroke(),i.gridContext.closePath()}}},this.startUpdatingArrows=function(){i.stopUpdatingArrows(),i.updateArrowsInterval=setInterval(i.updateArrows,i.updateArrowsThrottle)},this.stopUpdatingArrows=function(){i.updateArrowsInterval&&(window.clearInterval(i.updateArrowsInterval),i.updateArrowsInterval=void 0)},this.updateArrows=function(){if(i.isDrawingArrows)return;const o=(new Date).getTime();if(o<i.nextArrowsUpdate)return void(i.deferredArrowsDrawInterval||(i.deferredArrowsDrawInterval=window.setTimeout(i.updateArrows,i.nextArrowsUpdate+i.updateArrowsThrottle-o)));i.isDrawingArrows=!0,window.clearInterval(i.deferredArrowsDrawInterval),i.deferredArrowsDrawInterval=void 0,i.nextArrowsUpdate=o+i.updateArrowsThrottle;const n=t.nodes(),s=e(".nodes-holder").offset(),r=i.scale,a=3*r,l=8*r,d=8*r,c=[],u=[];i.canvas.width=e(window).width(),i.canvas.height=e(window).height(),i.context.lineWidth=a,i.context.strokeStyle=i.context.fillStyle=e(".arrows").css("color");for(let i of n)if(i.halfWidth=e(i.element).width()/2,i.halfHeight=e(i.element).height()/2,i.linkedTo().length)if("straight"===t.settings.lineStyle()){const e=(i.x()+i.halfWidth)*r+s.left,t=(i.y()+i.halfHeight)*r+s.top;for(let o of i.linkedTo()){const i=(o.x()+o.halfWidth)*r+s.left,n=(o.y()+o.halfHeight)*r+s.top,a=Math.sqrt((e-i)*(e-i)+(t-n)*(t-n)),p={x:(i-e)/a,y:(n-t)/a},g=(110+160*(1-Math.max(Math.abs(p.x),Math.abs(p.y))))*r,h={x:e+p.x*g,y:t+p.y*g},f={x:i-p.x*g,y:n-p.y*g};c.push({x1:h.x,y1:h.y,x2:f.x,y2:f.y}),u.push({x1:f.x+10*p.x,y1:f.y+10*p.y,x2:f.x-p.x*l-p.y*d,y2:f.y-p.y*l+p.x*d,x3:f.x-p.x*l+p.y*d,y3:f.y-p.y*l-p.x*d})}}else for(let e of i.linkedTo()){const t=(i.x()+i.halfWidth)*r+s.left,o=(i.y()+i.halfHeight)*r+s.top,n=(e.x()+e.halfWidth)*r+s.left,a=(e.y()+e.halfHeight)*r+s.top,g=(360-180*Math.atan2(a-o,n-t)/Math.PI)%360;let h,f,m,y;var p=!1;g<=45||g>=315?(p=!0,h=(i.x()+i.width)*r+s.left,f=(i.y()+i.halfHeight)*r+s.top,m=e.x()*r+s.left-l,y=(e.y()+e.halfHeight)*r+s.top,u.push({x1:m+l,y1:y,x2:m-l,y2:y-d,x3:m-l,y3:y+d})):g>45&&g<135?(p=!1,h=(i.x()+i.halfWidth)*r+s.left,f=i.y()*r+s.top,m=(e.x()+e.halfWidth)*r+s.left,y=(e.y()+i.height)*r+s.top+d,u.push({x1:m,y1:y-d,x2:m-l,y2:y+d,x3:m+l,y3:y+d})):g>=135&&g<=225?(p=!0,h=i.x()*r+s.left,f=(i.y()+i.halfHeight)*r+s.top,m=(e.x()+e.width)*r+s.left+l,y=(e.y()+e.halfHeight)*r+s.top,u.push({x1:m-l,y1:y,x2:m+l,y2:y-d,x3:m+l,y3:y+d})):g>225&&g<315&&(p=!1,h=(i.x()+i.halfWidth)*r+s.left,f=(i.y()+i.height)*r+s.top,m=(e.x()+e.halfWidth)*r+s.left,y=e.y()*r+s.top-d,u.push({x1:m,y1:y+d,x2:m-l,y2:y-d,x3:m+l,y3:y-d})),c.push({x1:h,y1:f,x2:m,y2:y,drawHorizontal:p})}i.context.beginPath();for(let e of c)i.context.moveTo(e.x1,e.y1),"straight"===t.settings.lineStyle()?i.context.lineTo(e.x2,e.y2):!0===e.drawHorizontal?i.context.bezierCurveTo(e.x2,e.y1,e.x1,e.y2,e.x2,e.y2):i.context.bezierCurveTo(e.x1,e.y2,e.x2,e.y1,e.x2,e.y2);i.context.stroke(),i.context.beginPath();for(let e of u)i.context.moveTo(e.x1,e.y1),i.context.lineTo(e.x2,e.y2),i.context.lineTo(e.x3,e.y3);i.context.fill(),i.isDrawingArrows=!1},this.bringToFront=function(t){const i=e(t),n=o.Utils.getHighestZ(i.parent());i.css("z-index",n+1)},this.selectAll=function(){i.selectNodes(t.nodes())},this.deselectAll=function(){i.deselectNodes(t.nodes())},this.selectNodes=function(e){const t=Array.isArray(e)?e:[e];for(let e of t)i.selectedNodes.includes(e)||(i.selectedNodes.push(e),e.setSelected(!0))},this.deselectNodes=function(e){const t=Array.isArray(e)?e:[e];for(let e of t){const t=i.selectedNodes.indexOf(e);t>=0&&(i.selectedNodes.splice(t,1),e.setSelected(!1))}},this.getSelectedNodes=function(){return 1===i.selectedNodes.length?[i.selectedNodes[0]]:Array.apply(this,i.selectedNodes)},this.warpToNodeByIdx=function(e){i.warpToNode(t.nodes()[e]),t.focusedNodeIdx=e},this.warpToSelectedNodeByIdx=function(e){i.warpToNode(i.getSelectedNodes()[e]),t.focusedNodeIdx=e},this.warpToNode=function(e){e&&i.warpToXY(e.x()||e.createX,e.y()||e.createY)},this.warpToXY=function(o,n){const s=-o*i.scale,r=-n*i.scale,a=e(window).width()/2,l=e(window).height()/2,d=100*i.scale/2,c=100*i.scale/2;i.setTranslation(s+a-d+t.getSplitEditorXOffset(),r+l-c,100)},this.alignV=function(){if(t.input.isCtrlDown)return void i.reduceAlignV();const e=t.nodes().filter(e=>e.selected).sort((e,t)=>e.y()>t.y()?1:e.y()<t.y()?-1:0);if(e.length<2)return void Swal.fire(n);const o=e.shift();e.forEach((e,t)=>{e.moveTo(o.x(),e.y())})},this.reduceAlignV=function(){const e=t.settings.gridSize(),o=t.nodes().filter(e=>e.selected).sort((e,t)=>e.y()>t.y()?1:e.y()<t.y()?-1:0);if(o.length<2)return void Swal.fire(n);const s=o.shift();t.settings.snapGridEnabled()&&s.moveTo(i.stepify(s.x(),t.settings.gridSize()),i.stepify(s.y(),t.settings.gridSize()));const r=e-(s.y()+s.height)%e+e;o.forEach((e,i)=>{const o=t.settings.snapGridEnabled()?s.y()+e.height*(i+1)+r*(i+1):s.y()+210*(i+1);e.moveTo(s.x(),o)})},this.alignH=function(){if(t.input.isCtrlDown)return void i.reduceAlignH();const e=t.nodes().filter(e=>e.selected).sort((e,t)=>e.x()>t.x()?1:e.x()<t.x()?-1:0);if(e.length<2)return void Swal.fire(n);const o=e.shift();e.forEach((e,t)=>{e.moveTo(e.x(),o.y())})},this.reduceAlignH=function(){const e=t.settings.gridSize(),o=t.nodes().filter(e=>e.selected).sort((e,t)=>e.x()>t.x()?1:e.x()<t.x()?-1:0);if(o.length<2)return void Swal.fire(n);const s=o.shift();t.settings.snapGridEnabled()&&s.moveTo(i.stepify(s.x(),e),i.stepify(s.y(),e));const r=e-(s.x()+s.width)%e+e;o.forEach((e,i)=>{const o=t.settings.snapGridEnabled()?s.x()+e.width*(i+1)+r*(i+1):s.x()+210*(i+1);e.moveTo(o,s.y())})},this.arrangeSpiral=function(){const e=i.getSelectedNodes();e.length<2?Swal.fire(n):(e.forEach((e,o)=>{e.moveTo(t.settings.snapGridEnabled()?i.stepify(Math.cos(.5*o)*(600+30*o),t.settings.gridSize()):Math.cos(.5*o)*(600+30*o),t.settings.snapGridEnabled()?i.stepify(Math.sin(.5*o)*(600+30*o),t.settings.gridSize()):Math.cos(.5*o)*(600+30*o))}),i.warpToXY(0,0))},this.sortAlphabetical=function(){const o=i.getSelectedNodes().sort((e,t)=>e.title().localeCompare(t.title()));if(o.length<2)return void Swal.fire(n);let s=Math.round(o.length/2),r=0,a=0;const l=e(o[0].element).width()+30,d=e(o[0].element).height()+30,c=t.settings.gridSize();t.settings.snapGridEnabled()&&o[0].moveTo(i.stepify(o[0].x(),c),i.stepify(o[0],c)),o.forEach((e,i)=>{i%s?r+=1:(a+=1,r=0),1===i&&(a=0);const n=o[0].x()+o[0].width,u=c-n%c+c,p=o[0].y()+o[0].height,g=c-p%c+c;e.moveTo(t.settings.snapGridEnabled()?o[0].x()+r*e.width+r*u:o[0].x()+r*l,t.settings.snapGridEnabled()?o[0].y()+a*e.height+a*g:o[0].y()+a*d)}),i.warpToNode(o[0])},this.stepify=function(e,t){return Math.round(e/t)*t}}}).call(this,i("EVdn"))},6:function(e,t){},7:function(e,t){},8:function(e,t){},9:function(e,t){},INAQ:function(e,t,i){"use strict";(function(e,o){i.d(t,"a",(function(){return s}));var n=i("oj90");const s=function(t){const i=this,s=Object.freeze({Left:0,Middle:1,Right:2}),r=Object.freeze({Enter:13,Escape:27,Space:32,Left:37,Up:38,Right:39,Down:40,Delete:46,A:65,C:67,D:68,O:79,S:83,V:86,W:87,X:88,Y:89,Z:90});this.mouse={x:0,y:0},this.isDragging=!1,this.isScreenTouched=!1,this.isMiddleButtonDown=!1,this.isLeftButtonDown=!1,this.isShiftDown=!1,this.isCtrlDown=!1,this.isHoverOverWorkspace=!1,this.trackMouseEvents=function(){e(document).on("pointerdown",e=>{if(i.isDragging="nodes"===e.target.className,i.mouse.x=e.pageX,i.mouse.y=e.pageY,i.isMiddleButtonDown=e.button===s.Middle,this.isLeftButtonDown=e.button===s.Left,t.inWorkspace()){if(i.isDragging)switch(e.button){case s.Left:t.workspace.onMarqueeStart({x:e.pageX,y:e.pageY});break;case s.Middle:t.workspace.onDragStart({x:e.pageX,y:e.pageY})}}else t.inEditor()&&e.button===s.Right&&(t.guessPopUpHelper(),e.preventDefault())}),window.addEventListener("touchstart",()=>{i.isScreenTouched=!0}),e(document).on("pointermove",e=>{i.mouse.x=e.pageX,i.mouse.y=e.pageY}),e(document).on("click","a",e=>{if(t.isElectron){e.preventDefault();var i=new CustomEvent("openLink");i.link=e.target.href,window.parent.dispatchEvent(i)}}),e(document).on("mousemove touchmove",e=>{if(i.isDragging){t.focusedNodeIdx=-1;const o=i.isScreenTouched&&e.changedTouches?e.changedTouches[0].pageX:e.pageX,n=i.isScreenTouched&&e.changedTouches?e.changedTouches[0].pageY:e.pageY;t.inWorkspace()&&(e.altKey||i.isMiddleButtonDown||i.isScreenTouched?t.workspace.onDragUpdate({x:o,y:n}):t.workspace.onMarqueeUpdate({x:o,y:n}))}}),e(document).on("pointerup touchend",e=>{i.isScreenTouched=!1,i.isDragging=!1,e.button===s.Left&&(i.isLeftButtonDown=!1),e.button===s.Middle&&(i.isMiddleButtonDown=!1),t.inWorkspace()&&(t.workspace.onDragEnd(),t.workspace.onMarqueeEnd())}),e(".nodes").mousewheel(e=>{e.altKey||(t.inWorkspace()||i.isHoverOverWorkspace)&&(t.workspace.onZoom(e.pageX,e.pageY,e.deltaY),e.preventDefault())}),e(".nodes").hover(()=>{i.isHoverOverWorkspace=!0},()=>{i.isHoverOverWorkspace=!1}),e(".nodes").on("pointerdown",()=>{t.isEditorSplit&&(t.focusEditor(!1),t.makeNewNodesFromLinks(),t.propagateUpdateFromNode(t.editing()),t.updateTagsRepository(),t.workspace.updateArrows())}),e(document).contextmenu(i=>{if(!t.inWorkspace())return;const o=e(i.target).hasClass("nodes");if(i.button===s.Right&&o&&t.settings.rightClickNodeCreation()){const{x:e,y:o}=t.workspace.toWorkspaceCoordinates(i.pageX,i.pageY);t.newNodeAt(e,o)}return!o})},this.trackKeyboardEvents=function(){e(document).on("keyup keydown",e=>{i.isShiftDown=e.shiftKey,i.isCtrlDown=e.ctrlKey}),e(document).on("keyup",(function(e){if(e.keyCode===r.Space){if(t.inWorkspace()&&e.altKey||t.inEditor()&&!e.altKey)return;t.workspace.scale=1;const i=t.workspace.getSelectedNodes(),o=i.length>0,n=o>0?i:t.nodes();++t.focusedNodeIdx,(t.focusedNodeIdx<0||t.focusedNodeIdx>=n.length)&&(t.focusedNodeIdx=0),t.inWorkspace()?o?t.workspace.warpToSelectedNodeByIdx(t.focusedNodeIdx):t.workspace.warpToNodeByIdx(t.focusedNodeIdx):t.inEditor()&&t.editNode(t.nodes()[t.focusedNodeIdx])}else e.keyCode===r.Z&&(t.previewStory.changeTextScrollSpeed(200),-1!=t.previewStory.vnSelectedChoice&&t.previewStory.vnSelectChoice())})),e(document).on("keydown",e=>{if(t.inWorkspace()){if((e.metaKey||e.ctrlKey)&&e.shiftKey)switch(e.keyCode){case r.A:t.data.tryAppend()}if((e.metaKey||e.ctrlKey)&&e.altKey)switch(e.keyCode){case r.S:t.data.trySave(n.FILETYPE.YARN)}else if(e.metaKey||e.ctrlKey)switch(e.keyCode){case r.C:t.nodeClipboard=t.cloneNodeArray(t.workspace.getSelectedNodes());break;case r.D:t.workspace.deselectAll();break;case r.O:t.data.tryOpenFile();break;case r.S:t.data.trySaveCurrent();break;case r.X:const e=t.workspace.getSelectedNodes();t.nodeClipboard=t.cloneNodeArray(e),t.deleteNodes(e);break;case r.Y:t.historyDirection("redo");break;case r.Z:t.historyDirection("undo")}else e.keyCode===r.Delete||"Delete"===e.key?t.confirmDeleteNodes(t.workspace.getSelectedNodes()):t.$searchField.is(":focus")||e.ctrlKey||e.metaKey||(e.keyCode===r.A||e.keyCode===r.Left?t.workspace.onPanLeft():e.keyCode===r.D||e.keyCode===r.Right?t.workspace.onPanRight():e.keyCode===r.W||e.keyCode===r.Up?t.workspace.onPanUp():e.keyCode!==r.S&&e.keyCode!==r.Down||t.workspace.onPanDown())}}),e(document).on("keyup",e=>{if(t.inWorkspace())if(e.metaKey||e.ctrlKey)switch(e.keyCode){case r.A:t.workspace.selectAll();break;case r.V:t.pasteNodes()}else if(e.keyCode===r.Enter||"Enter"===e.key){const e=t.nodes()[t.focusedNodeIdx];e?t.editNode(e):t.editNode(t.nodes()[0])}}),e(document).on("keydown",(function(e){if(t.inEditor())if(e.metaKey||e.ctrlKey)switch(e.keyCode){case r.C:i.clipboard=t.editor.getSelectedText();break;case r.X:document.execCommand("copy"),t.clipboard=t.editor.getSelectedText(),t.insertTextAtCursor("");break;case r.S:t.data.trySaveCurrent()}else switch(e.keyCode){case r.Escape:t.saveNode(),t.closeEditor()}})),e(document).on("keyup",(function(e){if(t.inEditor()&&(e.metaKey||e.ctrlKey)&&e.altKey)switch(e.keyCode){case r.Enter:t.saveNode(),t.closeEditor()}})),e(document).on("keydown",(function(e){if(t.ui.settingsDialogVisible())switch(e.keyCode){case r.Escape:t.ui.closeSettingsDialog()}})),e(document).on("keyup keydown pointerdown pointerup",(function(e){t.inEditor()&&t.updateEditorStats()})),e(document).on("keydown",e=>{if(t.editing()&&!t.previewStory.finished)switch(e.keyCode){case r.Z:t.previewStory.changeTextScrollSpeed(10),-1!=t.previewStory.vnSelectedChoice&&t.previewStory.vnSelectChoice();break;case r.Up:-1!=t.previewStory.vnSelectedChoice&&t.previewStory.vnUpdateChoice(-1);break;case r.Down:-1!=t.previewStory.vnSelectedChoice&&t.previewStory.vnUpdateChoice(1)}})},this.initKnockoutBindings=function(){o.bindingHandlers.preventBubble={init:function(e,t){var i=o.utils.unwrapObservable(t());o.utils.registerEventHandler(e,i,(function(e){e.cancelBubble=!0,e.stopPropagation&&e.stopPropagation()}))}},o.bindingHandlers.mousedown={init:function(t,i,n,s,r){var a=o.unwrap(i());e(t).mousedown((function(){a()}))}}};i.initKnockoutBindings(),i.trackMouseEvents(),i.trackKeyboardEvents()}}).call(this,i("EVdn"),i("kzO7"))},P0sH:function(e,t,i){"use strict";(function(e,o){i.d(t,"a",(function(){return m}));var n=i("owJe"),s=i("W2Rx"),r=i("5dEm"),a=i("INAQ"),l=i("pYPP"),d=i("fkuv"),c=i("2Qx2"),u=i("P3rc"),p=i("oj90"),g=i("l8+o"),h=i("PSD3"),f=i.n(h),m=function(t,h){const m=this;this.setTheme=function(t,i){let o=i?i.target.value:t;setTimeout(m.initGrid,50),setTimeout(m.workspace.updateArrows,50),e("#theme-stylesheet").attr("href",p.Utils.getPublicPath(`themes/${o}.css`))},this.setLanguage=function(e,t){const i=t?t.target.value:e;spoken.recognition.lang=i,Object(n.load_dictionary)(m.settings.spellCheckLanguage().split("-")[0])},this.setMarkupLanguage=function(e,t){t&&t.target.value;m.richTextFormatter=new g.a(m),m.mustRefreshNodes.notifySubscribers()},this.setPlaytestStyle=function(e,t){const i=t?t.target.value:e;m.playtestStyle=i},this.setGistCredentials=function(e,t){const{token:o,file:n}=e,s=new(i("XZLo"))({token:o});m.gists=s,m.gists.file=n},this.input=new a.a(m),this.settings=new l.a(m),this.workspace=new r.a(m),this.ui=new d.a(m),this.previewStory=new u.a,this.richTextFormatter=new g.a(m),this.data=c.a,this.name=o.observable(t),this.version=o.observable(h),this.editing=o.observable(null),this.nodes=o.observableArray([]),this.tags=o.observableArray([]),this.fileTags=[],this.mustRefreshNodes=o.observable(),this.nodeHistory=[],this.nodeFuture=[],this.editingHistory=[],this.editingSaveHistoryTimeout=null,this.focusedNodeIdx=-1,this.isElectron=!1,this.editor=null,this.nodeVisitHistory=[],this.clipboard="",this.nodeClipboard=[],this.speachInstance=null,this.editingPath=o.observable(null),this.$searchField=e(".search-field"),this.isEditorInPreviewMode=!1,this.isEditorInPlayMode=!1,this.isEditorSplit=!1,this.isEditorFocused=!1,this.editorResizeHandleOptions={handleSelector:"#editor-resize-handle",resizeHeight:!1,resizeWidthFrom:"right",onDragStart:function(){m.isSplitEditorInFocus=!0,e("#node-editor").removeClass("split-editor-out-of-focus")},onDragEnd:function(){m.editor.resize(),m.settings.editorSplitSize(e("#editor-form").width())}},this.inEditor=()=>(m.editing()||m.isEditorSplit&&m.isEditorFocused)&&!m.ui.isDialogOpen(),this.inWorkspace=()=>(!m.editing()||m.isEditorSplit&&!1===m.isEditorFocused)&&!m.ui.isDialogOpen(),this.run=function(){var t="Unknown OS";-1!=navigator.platform.indexOf("Win")&&(t="Windows"),-1!=navigator.platform.indexOf("Mac")&&(t="MacOS"),-1!=navigator.platform.indexOf("X11")&&(t="UNIX"),-1!=navigator.platform.indexOf("Linux")&&(t="Linux"),-1!=navigator.platform.indexOf("Linux")&&(t="Linux"),m.isElectron=navigator.userAgent.toLowerCase().includes("electron");var i=navigator.userAgent||navigator.vendor||window.opera;let n;/android|iPad|iPhone|iPod/.test(i.toLowerCase())&&!window.MSStream&&(t="mobile"),"Windows"==t&&(m.workspace.zoomSpeed=.1),window.addEventListener("beforeunload",e=>(this.data.saveAppStateToLocalStorage(),null)),window.addEventListener("DOMContentLoaded",e=>{if(m.electron){let e=m.electron.remote.process.argv.length>1?m.electron.remote.process.argv[1]:null;if(e&&app.fs.existsSync(e))return void this.data.openFileFromFilePath(e)}this.data.loadAppStateFromLocalStorage();const t=new URL(window.location),i=t.searchParams.get("text")||t.searchParams.get("url");null!==i&&m.insertTextAtCursor(i)});const s=e("#addPwa")[0];s.style.display="none",window.addEventListener("beforeinstallprompt",e=>{e.preventDefault(),n=e,s.style.display="block",s.addEventListener("click",e=>{s.style.display="none",n.prompt(),n.userChoice.then(e=>{"accepted"===e.outcome?(console.log("User accepted the A2HS prompt"),s.style.display="none"):console.log("User dismissed the A2HS prompt"),n=null})})}),e("#app").show(),o.applyBindings(m,e("#app")[0]),m.editingVisualStudioCodeFile()||m.newNode().title("Start"),m.settings.apply(),setTimeout(()=>{m.setLanguage(m.settings.spellCheckLanguage())},250),e(".search-title input").click(m.updateSearch),e(".search-body input").click(m.updateSearch),e(".search-tags input").click(m.updateSearch),m.$searchField.on("input",m.updateSearch),m.$searchField.on("keyup",(function(e){27==e.keyCode?m.clearSearch():m.searchWarp()})),"mobile"===t&&m.workspace.setZoom(3),e(window).on("resize",(function(){m.ui.isScreenNarrow()&&m.editing()&&m.isEditorSplit&&m.toggleEditorView(),m.workspace.updateArrows(),m.initGrid()})),setTimeout(m.initGrid,50),this.guessPopUpHelper=function(){/color=#([a-zA-Z0-9]{3,6})$/.test(m.getTagBeforeCursor())&&m.insertColorCode()},this.insertEmoji=function(){this.emPicker.toggle(),m.togglePreviewMode(!0),e("#emojiPicker-container").css({left:m.input.mouse.x-200,top:m.input.mouse.y-125}),e("#emojiPicker-container").show()},this.showAboutDialog=function(){f.a.fire({title:m.version(),html:'<a href="https://github.com/FaultyFunctions/Crochet" target="_blank">https://github.com/FaultyFunctions/Crochet</a>',imageUrl:"public/Crochet_Banner.png"})},this.insertColorCode=function(){e("#colorPicker-container").is(":visible")||(e("#colorPicker").spectrum("set",m.editor.getSelectedText()),e("#colorPicker").spectrum("toggle"),e("#colorPicker-container").css({left:m.input.mouse.x-70,top:m.input.mouse.y-50}),e("#colorPicker-container").show(),m.togglePreviewMode(!0),setTimeout(()=>{const t=e("#colorPicker").spectrum("get");m.applyPickerColorEditor(t)},100))},this.applyPickerColorEditor=function(e){const t=JSON.parse(JSON.stringify(m.editor.selection.getRange()));m.editor.selection.setRange(t);const i=e.toHexString().replace("#","");m.editor.session.replace(t,i),m.editor.selection.setRange({start:m.editor.getCursorPosition(),end:{row:m.editor.getCursorPosition().row,column:m.editor.getCursorPosition().column-i.length}}),m.togglePreviewMode(!0)},document.addEventListener("contextmenu",(function(e){m.editing()&&e.preventDefault()}),!1),this.speakText=function(){const e=m.editor.getSelectedText(),t=e||m.editor.getSession().getValue();spoken.voices().then(e=>{const i=m.settings.spellCheckLanguage().split("-")[0],o=e.filter(e=>!e.lang.indexOf(i));o.length?(console.log("Loaded voice",o[0]),spoken.say(t,o[0])):spoken.say(t)})},this.startCapture=function(){spoken.listen({continuous:!0}).then(e=>{if(console.log(e),m.editing())m.insertTextAtCursor(e+". "),document.getElementById("speakTextBtnBubble").title="Transcribe";else if("open"===e){console.log("try open...");var t=m.getFirstFoundNode(m.$searchField.val().toLowerCase()).title();console.log("try open:",t),m.openNodeByTitle(t)}else"clear"===e?(m.$searchField.val(""),m.updateSearch()):(m.$searchField.val(e),m.updateSearch());spoken.listen.stop().then(()=>{m.editing()&&(document.getElementById("speakTextBtnBubble").style.visibility="hidden"),this.continueCapture()})}).catch(e=>spoken.listen.stop().then(()=>this.continueCapture()))},this.continueCapture=function(){spoken.delay(500).then(()=>{spoken.recognition.continuous&&m.startCapture()})},this.toggleTranscribing=function(){const e=spoken.listen.available();var t=document.getElementById("speakTextBtnBubble");e&&m.settings.transcribeEnabled()?(spoken.listen.on.partial(e=>{m.editing()?(t.style.visibility="visible",t.title=`🗣️ ${e} 🦜`):m.$searchField.val(`🗣️ ${e} 🦜`)}),m.startCapture()):(t.style.visibility="hidden",spoken.recognition.continuous=!1,spoken.listen.stop())},this.hearText=function(){spoken.listen.available()?(spoken.listen.on.partial(e=>{console.log(e),document.getElementById("speakTextBtnBubble").title=`🗣️ ${e} 🦜`}),spoken.listen().then(e=>{m.insertTextAtCursor(e+" "),document.getElementById("speakTextBtnBubble").title="Transcribe"}).catch(e=>console.warn(e.message))):f.a.fire({title:"Speech recognition not avaiilable!",icon:"error"})},document.ondragover=document.ondrop=e=>{e.preventDefault()},document.body.ondrop=e=>{e.preventDefault();for(var t=0;t<e.dataTransfer.files.length;t++)c.a.appendFile(e.dataTransfer.files[t],e.dataTransfer.files[t].name,!1)},window.addEventListener("message",e=>{const t=e.data;switch(t.type){case"UpdateNode":m.nodes().forEach(e=>{e.title().trim()===t.payload.originalNodeTitle.trim()&&(e.title(t.payload.title),e.tags(t.payload.tags),e.body(t.payload.body),m.setYarnDocumentIsDirty())})}});var r=new CustomEvent("yarnReady");r.document=document,r.data=c.a,r.app=this,window.parent.dispatchEvent(r)},this.limitNodesUpdate=function(e){e(),m.nodes.extend({rateLimit:{method:"notifyWhenChangesStop",timeout:250}})},this.getNodesConnectedTo=function(e){var t=[],i=m.nodes();for(var o in i)if(i[o]!=e&&i[o].isConnectedTo(e,!0)){var n=!1;for(var s in t)if(t[s]==i[o]){n=!0;break}n||t.push(i[o])}return t},this.matchConnectedColorID=function(e){var t=m.getNodesConnectedTo(e);for(var i in t)t[i].colorID(e.colorID())},this.quit=function(){m.isElectron},this.validateTitle=function(t){var i=document.getElementById("editorTitle").value,o=e("#editorTitle");const n=f.a.mixin({icon:"error",title:"Title Error"}),s=function(){null!==m.editing()&&o.trigger("focus")};m.getOtherNodeTitles().includes(i)||m.titleExistsTwice(i)?(o.attr("class","title title-error"),o.attr("title","Two nodes cannot share the same title."),o.on("focusout",()=>{n.fire({text:"Two nodes cannot share the same title."}).then(()=>{s()})})):RegExp("^[\\u0000-\\u0020]+$","i").test(i)?(o.attr("class","title title-error"),o.attr("title","Invalid character in title."),o.on("focusout",()=>{n.fire({text:"Invalid character in title."}).then(()=>{s()})})):0===i.length?(o.attr("class","title title-error"),o.attr("title","Titles must contain one or more characters."),o.on("focusout",()=>{n.fire({text:"Title must be greater than 0 character in length."}).then(()=>{s()})})):(o.removeAttr("title"),o.removeClass("title-error"),o.off("focusout"),m.updateNodeLinks())},this.validateTags=function(){var t=e("#editorTags"),i=t.val().replace(/\s+/g," ").replace(/^\s+/g,"");t.val(i),m.updateTagsRepository()},this.refreshWindowTitle=function(){let e="";"LOCAL"===c.a.lastStorageHost()?e="Crochet "+m.version()+" - "+(c.a.editingPath()||c.a.editingName())+" "+(c.a.isDocumentDirty()?"*":""):"GIST"===c.a.lastStorageHost()&&(e="Gist - "+(c.a.editingPath()||c.a.editingName())+" "+(c.a.isDocumentDirty()?"*":"")),m.electron?m.electron.remote.getCurrentWindow().setTitle(e):document.title=e},this.usingVisualStudioCodeExtension=function(){return!!window.vsCodeApi},this.editingVisualStudioCodeFile=function(){return!0===window.editingVsCodeFile},this.setYarnDocumentIsDirty=function(){m.usingVisualStudioCodeExtension()&&m.editingVisualStudioCodeFile()&&window.vsCodeApi.postMessage({type:"DocumentEdit",payload:c.a.getSaveData(c.a.editingType())})},this.recordNodeAction=function(e,t){if(m.nodeFuture.length>0){for(var i=0;i<m.nodeFuture.length;i++){delete m.nodeFuture.pop().node}delete m.nodeFuture,m.nodeFuture=[]}var o={action:e,node:t,lastX:t.x(),lastY:t.y()};"removed"==e&&(o.lastY+=80),m.nodeHistory.push(o),m.setYarnDocumentIsDirty()},this.historyDirection=function(e){function t(e){var t=m.nodes.indexOf(e);t>=0&&m.nodes.splice(t,1),m.updateNodeLinks()}var i=null;if(i="undo"==e?m.nodeHistory.pop():m.nodeFuture.pop()){var o=i.action,n=i.node;"undo"==e?("created"==o?(i.lastX=n.x(),i.lastY=n.y(),t(n)):"removed"==o&&m.recreateNode(n,i.lastX,i.lastY),m.nodeFuture.push(i),m.setYarnDocumentIsDirty()):("created"==o?m.recreateNode(n,i.lastX,i.lastY):"removed"==o&&t(n),m.nodeHistory.push(i),m.setYarnDocumentIsDirty())}},this.recreateNode=function(e,t,i){m.nodes.push(e),e.moveTo(t,i),m.updateNodeLinks()},this.setSelectedColors=function(e){var t=m.workspace.getSelectedNodes();for(var i in t.splice(t.indexOf(e),1),t)t[i].colorID(e.colorID())},this.pasteNodes=function(){m.nodeClipboard.length&&(m.workspace.deselectAll(),m.nodeClipboard.forEach((function(e){var t=new s.a({title:m.getUniqueTitle(e.title()),body:e.body(),tags:e.tags(),colorID:e.colorID(),x:e.createX,y:e.createY});m.nodes.push(t),m.workspace.selectNodes(t),m.recordNodeAction("created",t)})),m.updateNodeLinks())},this.confirmDeleteNodes=function(e){const t=Array.isArray(e)?void 0:e,i=Array.isArray(e)?[...e]:t&&t.selected?[...m.workspace.getSelectedNodes()]:[e];i.length&&f.a.fire({title:"Are you sure?",text:`${i.length} ${1===i.length?"node":"nodes"} will be deleted.`,icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, delete!",cancelButtonText:"No, cancel!",reverseButtons:!0}).then(e=>{e.value&&m.deleteNodes(i)})},this.deleteNodes=function(e){const t=Array.isArray(e)?e:[e],i=[];for(let e=t.length-1;e>=0;--e)i.push(t[e].remove());Promise.all(i).then(()=>{m.limitNodesUpdate(()=>{for(let e=t.length-1;e>=0;--e)m.inEditor()&&m.editing()===t[e]&&m.closeEditor(),m.deleteNode(t[e]);m.updateNodeLinks(),m.workspace.deselectNodes(t),m.workspace.updateArrows()})})},this.deleteNode=function(e){const t=m.nodes.indexOf(e);t>=0&&(m.recordNodeAction("removed",e),m.nodes.splice(t,1)),m.setYarnDocumentIsDirty()},this.cloneNodeArray=function(e){return e.map((function(e){return new s.a({title:e.title(),body:e.body(),tags:e.tags(),colorID:e.colorID(),x:e.x()+10,y:e.y()+10})}))},this.newNode=function(e=!0){var t=new s.a;return m.nodes.push(t),e&&m.updateNodeLinks(),m.recordNodeAction("created",t),t},this.newNodeAt=function(e,t){var i=new s.a({x:e,y:t});return m.nodes.push(i),m.updateNodeLinks(),m.recordNodeAction("created",i),i},this.searchTextInEditor=function(e=!0){e?m.editor.execCommand("find"):m.editor.searchBox&&m.editor.searchBox.hide()},this.showRandomQuote=function(){e.ajax({url:"https://api.forismatic.com/api/1.0/?",dataType:"jsonp",data:"method=getQuote&format=jsonp&lang=en&jsonp=?",success:function(e){f.a.fire({text:e.quoteText+"\n\n-"+e.quoteAuthor})}})},this.editNode=function(t){if(!t.active())return;if(m.settings.alwaysOpenNodesInVisualStudioCodeEditor())return void m.editNodeInVisualStudioCodeEditor(t);m.editing()&&m.editing()!==t&&m.saveNode(!1),m.isEditorInPlayMode&&m.togglePlayMode(!1),m.isEditorInPreviewMode&&m.togglePreviewMode(!1),t.oldTitle=t.title(),m.editing(t),e("#node-editor-background").css({opacity:0}).transition({opacity:1},250),e("#node-editor").css({y:"-100",opacity:0}).transition({y:"0",opacity:1},250),m.editor=ace.edit("editor"),m.editor.setOptions({scrollPastEnd:.5,fontSize:m.settings.editorFontSize()}),m.editor.navigateFileEnd(),e("#colorPicker").spectrum({flat:!0,showButtons:!1,showInput:!0,showPalette:!0,preferredFormat:"hex",palette:[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"]],move:function(e){m.applyPickerColorEditor(e)},clickoutFiresChange:!0});const i=ace.require("ace/ext/language_tools"),o=p.Utils.createAutocompleter(["string.llink","string.rlink"],m.getOtherNodeTitles(),"Node Link");i.setCompleters([o,i.keyWordCompleter,i.textCompleter,i.snippetCompleter]);let s=void 0;m.editor.getSession().on("change",(function(e){const t=m.settings.autoCloseTags();if("insert"===e.action&&t){if(m.richTextFormatter.justInsertedAutoComplete)return void(m.richTextFormatter.justInsertedAutoComplete=!1);s&&clearTimeout(s),s=setTimeout(()=>{s=void 0,m.richTextFormatter.completableTags.forEach(e=>{if(m.getTagBeforeCursor()===e.Start){m.richTextFormatter.justInsertedAutoComplete=!0;let t=e.Completion,i=e.Offset;m.settings.autoCloseBrackets()&&e.BehaviorCompletion&&(t=e.BehaviorCompletion,i+=1),e.Completion&&m.insertTextAtCursor(t),e.Offset&&m.moveEditCursor(i),e.Func&&e.Func()}})},200)}})),this.emPicker=new EmojiPicker(document.getElementById("emojiPickerDom"),e=>{m.insertTextAtCursor(e.char),this.emPicker.toggle(),m.togglePreviewMode(!1)}),Object(n.enable_spellcheck)(),m.toggleTranscribing(),m.toggleInvertColors(),m.toggleShowCounter(),m.toggleSpellCheck(),m.validateTitle(),m.validateTags(),m.updateEditorStats(),m.updateEditorOptions(),m.$searchField.val().length>0&&e(".search-body input").is(":checked")&&m.editor.findAll(m.$searchField.val()),m.settings.editorSplit()&&(m.splitEditor(),m.workspace.warpToNodeByIdx(t.index()-1)),"right"===m.settings.editorSplitDirection()?(e("#editor-form").addClass("split-editor-right"),e("#editor-resize-handle").addClass("float-right")):(e("#editor-form").removeClass("split-editor-right"),e("#editor-resize-handle").removeClass("float-right")),e(".node-editor").on("pointerdown","> *",(function(e){m.isEditorSplit&&(m.focusEditor(!0),e.stopPropagation())})),m.editor.resize(),null!=t.undoManager&&m.editor.session.setUndoManager(t.undoManager)},this.splitEditor=function(){m.isEditorSplit=!0,m.focusEditor(!0),m.settings.editorSplit(!0),m.editorResizeHandleOptions.resizeWidthFrom="right"===m.settings.editorSplitDirection()?"left":"right",e("#editor-form").width(m.settings.editorSplitSize()).addClass("split-editor").toggleClass("split-editor-right","right"===m.settings.editorSplitDirection()).resizable(m.editorResizeHandleOptions),e("#node-editor-background").addClass("hidden"),e("#node-editor").css({"z-index":10002}),e("#editor-resize-handle").removeClass("hidden").toggleClass("float-right","right"===m.settings.editorSplitDirection()),e("#split-editor-button").addClass("hidden"),e("#snap-editor-button").removeClass("hidden"),e("#exit-editor").removeClass("hidden"),e("#full-size-editor-button").removeClass("hidden"),e("#split-button-separator").removeClass("hidden"),m.ui.checkAndMoveAppButtons()},this.toggleEditorView=function(){m.settings.editorSplit(!m.settings.editorSplit()),m.reopenEditor()},this.reopenEditor=function(){m.saveNode();let e=m.editing();m.closeEditor(),setTimeout(()=>{m.editNode(e)},250)},this.editorSnapToggle=function(){m.settings.editorSplitDirection("right"===m.settings.editorSplitDirection()?"left":"right"),m.reopenEditor()},this.focusEditor=function(t){!0===t?(e("#node-editor").removeClass("split-editor-unfocused"),m.isEditorFocused=!0):(e("#node-editor").addClass("split-editor-unfocused"),m.isEditorFocused=!1)},this.getSplitEditorXOffset=function(){let t=0;return m.inEditor()&&m.settings.editorSplit()&&(t=e("#editor-form").width()/2,"right"===m.settings.editorSplitDirection()&&(t*=-1)),t},this.editNodeInVisualStudioCodeEditor=function(e){m.usingVisualStudioCodeExtension()?(m.setYarnDocumentIsDirty(),window.vsCodeApi.postMessage({type:"OpenNode",payload:{title:e.title().trim(),tags:e.tags().trim(),body:m.trimBodyLinks(e.body().trim())}})):console.error("Tried to open node in Visual Studio Code text editor but we're not in the Visual Studio Code extension")},this.chooseRelativePathImage=function(e){m.insertTextAtCursor(e)},this.openNodeByTitle=function(e){m.makeNodeWithName(e),m.nodes().forEach(t=>{t.title().trim().toLowerCase()===e.trim().toLowerCase()&&m.editNode(t)})},this.openLastEditedNode=function(){if(0===m.nodeVisitHistory.length)m.saveNode(),m.closeEditor();else{const e=m.nodeVisitHistory.pop();m.propagateUpdateFromNode(m.editing()),m.openNodeByTitle(e)}},this.getSpellCheckSuggestionItems=function(){var e=Object(n.suggest_word_for_misspelled)(m.editor.getSelectedText());if(e){var t={};return e.forEach(e=>{t[e]={name:e,icon:"edit",callback:e=>{m.insertTextAtCursor(e)}}}),t}return!1},this.getThesaurusItems=function(){var e=i("GLdW")(m.editor.getSelectedText());if(!e)return!1;var t=[];if(Object.keys(e).forEach((function(i){e[i].forEach((function(e){t.includes(e)||e===i||t.push(e)}))})),t.length>0){var o={};return t.forEach(e=>{o[e]={name:e,icon:"edit",callback:e=>{m.insertTextAtCursor(e)}}}),o}return!1},this.toggleSpellCheck=function(){setTimeout((function(){m.settings.spellcheckEnabled()?Object(n.enable_spellcheck)():Object(n.disable_spellcheck)()}),50)},this.toggleInvertColors=function(){const t=m.settings.invertColorsEnabled()?{filter:"invert(100%)"}:{filter:"invert(0%)"};e("#app").css(t),e("#app-bg").css(t),e(".tooltip").css(t),e(".node .body").css(t),e(".node-editor .form .editor-container .editor-preview").css(t)},this.initGrid=function(){if(m.settings.snapGridEnabled()){var t=e(window).width(),i=e(window).height();e("#grid-canvas").attr("width",t),e("#grid-canvas").attr("height",i),e("#gridSize").attr("disabled",!1),m.workspace.gridContext.strokeStyle=m.workspace.gridContext.fillStyle=e(".grid-canvas").css("color")}else e("#gridSize").attr("disabled",!0);app.workspace.updateGrid()},this.toggleShowCounter=function(){m.settings.editorStatsEnabled()?e(".node-editor .form .editor-counter").css({display:"initial"}):e(".node-editor .form .editor-counter").css({display:"none"})},this.toggleAutocompleteSuggestions=function(){m.settings.autocompleteSuggestionsEnabled(!m.settings.autocompleteSuggestionsEnabled()),m.updateEditorOptions()},this.toggleAutoCloseBrackets=function(){m.settings.autoCloseBrackets(!m.settings.autoCloseBrackets()),m.updateEditorOptions()},this.updateEditorOptions=function(){m.editor.setOptions({enableBasicAutocompletion:app.settings.autocompleteSuggestionsEnabled(),enableLiveAutocompletion:app.settings.autocompleteSuggestionsEnabled(),behavioursEnabled:app.settings.autoCloseBrackets()})},this.advanceStoryPlayMode=function(e=5){m.previewStory.finished?(m.togglePlayMode(!1),m.gotoLastPlayNode()):(m.previewStory.changeTextScrollSpeed(e),-1!=m.previewStory.vnSelectedChoice&&5===e&&m.previewStory.vnSelectChoice())},this.togglePlayMode=function(t=!1){var i=e(".editor")[0],o=document.getElementById("storyPlayButton"),n=document.getElementById("editor-play");m.isEditorInPlayMode=t,t?(m.togglePreviewMode(!1),i.style.display="none",n.style.display="flex",e(o).addClass("disabled"),e(".toggle-toolbar").addClass("hidden"),e(".editor-counter").addClass("hidden"),m.previewStory.emiter.on("finished",(function(){m.togglePlayMode(!1),m.gotoLastPlayNode()})),m.previewStory.emiter.on("startedNode",(function(e){m.isEditorSplit&&m.workspace.warpToNode(m.getFirstFoundNode(e.title.toLowerCase().trim()))})),m.previewStory.initYarn(JSON.parse(c.a.getSaveData(p.FILETYPE.JSON)),m.editing().title().trim(),"NVrichTextLabel",!1,"commandDebugLabel",m.playtestStyle)):(m.editor.session.setScrollTop(n.scrollTop),n.style.display="none",i.style.display="flex",e(o).removeClass("disabled"),e(".toggle-toolbar").removeClass("hidden"),e(".editor-counter").removeClass("hidden"),m.previewStory.terminate())},this.gotoLastPlayNode=function(){m.editing()&&m.editing().title()!==m.previewStory.node.title&&m.openNodeByTitle(m.previewStory.node.title),m.editor.focus()},this.togglePreviewMode=function(t){const i=e(".editor")[0],o=e("#editor-preview")[0];m.isEditorInPreviewMode=t,t?(m.isEditorInPlayMode&&(m.togglePlayMode(!1),m.gotoLastPlayNode()),e(".bbcode-toolbar").addClass("hidden"),i.style.display="none",o.style.display="block",o.innerHTML=m.richTextFormatter.richTextToHtml(m.editing().body(),!0),o.scrollTop=m.editor.renderer.scrollTop):(e(".bbcode-toolbar").removeClass("hidden"),m.editor.session.setScrollTop(o.scrollTop),o.innerHTML="",o.style.display="none",i.style.display="flex",m.editor.focus(),m.editor.resize(),e("#colorPicker-container").is(":visible")&&e("#colorPicker-container").hide(),e("#emojiPicker-container").is(":visible")&&e("#emojiPicker-container").hide())},this.appendText=function(e){m.editing().body(m.editing().body()+e);var t=m.editor.session.getLength()-1,i=m.editor.session.getLine(t).length;m.editor.gotoLine(t+1,i)},this.moveEditCursor=function(e){var t=m.editor.getCursorPosition();m.editor.gotoLine(t.row+1,t.column+e),m.editor.focus()},this.insertTextAtCursor=function(e){m.editing()&&(m.editor.session.replace(m.editor.selection.getRange(),""),m.editor.session.insert(m.editor.getCursorPosition(),e),m.editor.focus())},this.getTagBeforeCursor=function(){const e=m.editor.getSelectionRange(),t=e.end.column,i=e.start.row,o=m.editor.session.getLine(i).substring(0,t);return o?m.richTextFormatter.identifyTag(o):""},this.saveNode=function(){const t=m.editing();if(t){const i=e("#editorTitle")[0];m.previewStory.terminate();const o=m.getFutureEditedNodeTitle();i.value=o,t.title(o),t.body(m.trimBodyLinks(t.body().trim())),m.makeNewNodesFromLinks(),m.propagateUpdateFromNode(t),m.workspace.updateArrows(),setTimeout(m.updateSearch,600),m.setYarnDocumentIsDirty()}},this.closeEditor=function(){m.editing().undoManager=m.editor.session.getUndoManager(),e("#node-editor-background").transition({opacity:0},250),e("#node-editor").transition({y:"-100",opacity:0},250,(function(e){m.editing(null)})),m.isEditorSplit=!1,m.isEditorFocused=!1,app.ui.resetAppButtonsLocation(),m.isEditorInPlayMode&&m.togglePlayMode(!1),m.isEditorInPreviewMode&&m.togglePreviewMode(!1)},this.convertMarkup=function(){m.nodes().forEach(e=>{e.body(m.richTextFormatter.convert(e.body()))})},this.updateSearch=function(){for(var t=m.$searchField.val().toLowerCase(),i=e(".search-title input").is(":checked"),o=e(".search-body input").is(":checked"),n=e(".search-tags input").is(":checked"),s=0;s<m.nodes().length;s++){var r=m.nodes()[s],a=e(r.element);if(t.length>0&&(i||o||n)){var l=i&&r.title().toLowerCase().indexOf(t)>=0,d=o&&r.body().toLowerCase().indexOf(t)>=0,c=n&&r.tags().toLowerCase().indexOf(t)>=0;l||d||c?(r.active({title:l,body:d,tags:c}),a.clearQueue(),a.transition({opacity:1},500)):(r.active(!1),a.clearQueue(),a.transition({opacity:.25},500))}else r.active(!0),a.clearQueue(),a.transition({opacity:1},500)}},this.trimBodyLinks=function(e){return e.replace(/<<jump\s+(.+?)\s*>>/g,"<<jump $1>>")},this.updateNodeLinks=function(){for(let e of m.nodes())e.updateLinks()},this.propagateUpdateFromNode=function(e){var t=[],i=[];for(t.push(e);e=t.pop();)i.includes(e)||(i.push(e),e.updateLinks(),e.linkedTo().forEach(e=>{i.includes(e)||t.push(e)}),e.linkedFrom().forEach(e=>{i.includes(e)||t.push(e)}))},this.updateTagsRepository=function(){m.tags().forEach(e=>e.count=0),m.nodes().forEach(e=>{p.Utils.uniqueSplit(e.tags()," ").forEach(e=>{const t=m.tags().find(t=>t.text==e);if(t)++t.count;else{const t=(()=>{const e=m.tags().map(e=>e.id);for(let t=1;;++t)if(!e.includes(t))return t})();m.tags.push({id:t,style:"tag-style-"+t,text:e,count:1})}})});let e=m.tags().length;for(;e--;)0===m.tags()[e].count&&m.tags().splice(e,1)},this.makeNewNodesFromLinks=function(){if(!m.settings.createNodesEnabled())return console.info("Autocreate new nodes disabled");var e=m.editing().getLinksInNode();if(null!=e)for(var t=0;t<e.length;t++){const o=e[t].trim();var i=220*(t+1);m.makeNodeWithName(o,i)}},this.makeNodeWithName=function(e,t=220){const i=m.getOtherNodeTitles();e&&e.length>0&&!i.includes(e)&&e!=m.editing().title()&&m.newNodeAt(m.editing().x()+t,m.editing().y()-120).title(e)},this.titleExistsTwice=function(e){return m.nodes().filter(t=>t.title().trim()===e.trim()).length>1},this.getFutureEditedNodeTitle=function(){const t=e("#editorTitle")[0];return m.getUniqueTitle(t.value.trim())},this.getOtherNodeTitles=function(){var e=[];return m.nodes().forEach(t=>{m.editing()&&t.title()===m.editing().title()||e.push(t.title().trim())}),e},this.getHighlightedText=function(e){return e=(e=(e=(e=(e=(e=(e=(e=(e=(e=e.replace(/\</g,"&lt;")).replace(/\>/g,"&gt;")).replace(/(["|'].*?["|'])/g,'<p class="string">$1</p>')).replace(/(&lt;&lt;|&gt;&gt;)/g,'<p class="command_tag">$1</p>')).replace(/(\{|\})/g,'<p class="expression_tag">$1</p>')).replace(/#([^\/\/]+)/g,'<p class="hashtag">#$1</p>')).replace(/\/\/(.*)/g,'<span class="comment">//$1</span>')).replace(/(stop|else|endif)/g,'<p class="keyword">$1</p>')).replace(/(set|declare|if|elseif|jump)(\s+)/g,'<p class="keyword">$1$2</p>')).replace(/(\$\w*)/g,'<p class="variable">$1</p>')},this.updateLineNumbers=function(t){for(var i=t.split("\n"),o="",n=0;n<Math.max(1,i.length);n++)(0==n||n<i.length-1||i[n].length>0)&&(o+=n+1+"<br />");e(".editor-container .lines").html(o)},this.moveNodes=function(e,t){for(var i in m.nodes()){var o=m.nodes()[i];o.moveTo(o.x()+e,o.y()+t)}},this.getFirstFoundNode=function(e){return m.nodes().find(t=>t.title().toLowerCase().trim()===e)},this.searchWarp=function(){var e=m.$searchField.val().toLowerCase().trim();if(""===e)m.workspace.warpToNodeByIdx(0);else{const t=m.getFirstFoundNode(e);m.workspace.warpToNodeByIdx(m.nodes.indexOf(t))}},this.clearSearch=function(){m.$searchField.val(""),m.updateSearch()},this.updateEditorStats=function(){var t=m.editor.getSession().getValue(),i=m.editor.getCursorPosition(),o=t.split("\n");e(".editor-counter .character-count").html(t.length),e(".editor-counter .line-count").html(o.length),e(".editor-counter .row-index").html(i.row),e(".editor-counter .column-index").html(i.column),c.a.saveAppStateToLocalStorage()},this.getUniqueTitle=function(e){var t=m.getOtherNodeTitles();if(e&&!t.includes(e))return e;var i=e||"Node",o=2;const n=i.match(/^(.*)(_([0-9]+))$/);if(n&&4===n.length&&(i=n[1],o=Number(n[3])),!t.includes(i))return i;for(;;++o){var s=i+"_"+o;if(!t.includes(s))return s}}}}).call(this,i("EVdn"),i("kzO7"))},P3rc:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));const o=i("Wd8k"),n=i("L8pc"),s=new o.Runner,r=i("+qE3").EventEmitter;var a=function(){this.visitedNodes=[];this.node={title:""};let e=new r;this.emiter=e;let t=[];this.commandsPassedLog=t;this.commandPassed="";let i=!0;this.finished=i,this.scrollTextStyle=!1,this.visitedChapters=[],this.self=this,this.vnChoiceSelectionCursor=">",this.startTimeWait,this.vnSelectedChoice=-1,this.vnTextScrollInterval,this.storyChapter="",this.choices={};let o,a,l,d,c,u,p,g,h=null;this.vnSelectChoice=()=>{(new Date).getTime()-this.startTimeWait<1e3||(this.choices[this.storyChapter].push(d.options[this.vnSelectedChoice]),d.select(this.vnSelectedChoice),this.emiter.emit("choiceMade",d.options[this.vnSelectedChoice]),a="",o=void 0,d=self.goToNext(),this.vnSelectedChoice=-1,this.changeTextScrollSpeed(111))},this.vnUpdateChoice=(t=0)=>{if(this.vnSelectedChoice<0)return;let i=this.vnSelectedChoice+t;i>d.options.length-1?i=0:i<0&&(i=d.options.length-1),this.vnSelectedChoice=i,o=document.createElement("DIV"),d.options.forEach((e,t)=>{const i=document.createElement("DIV");t==this.vnSelectedChoice?i.innerHTML=`${this.vnChoiceSelectionCursor} [${e}]`:i.innerHTML=`${this.vnChoiceSelectionCursor.replace(/.*/gm,"&nbsp;")} [${e}]`,i.onclick=e=>{e.stopPropagation(),this.vnSelectedChoice=t,this.vnUpdateChoice()},i.ondblclick=e=>{e.stopPropagation(),this.vnSelectedChoice=t,this.vnSelectChoice()},i.className="storyPreviewChoiceButton",o.appendChild(i)}),e.emit("choiceUpdated",this.vnSelectedChoice),self.updateVNHud()},this.changeTextScrollSpeed=(t=0)=>{if(t!==this.vnTextScrollInterval){if(this.vnTextScrollInterval=t,clearInterval(u),h<0){if(this.isFinishedParsing(d))return void e.emit("finished");if("TextResult"===d.constructor.name)return a=d.text,h=0,e.emit("textResult",a),void this.changeTextScrollSpeed(220);"OptionsResult"===d.constructor.name&&-1===this.vnSelectedChoice&&(this.vnSelectedChoice=0,this.vnUpdateChoice(),this.startTimeWait=(new Date).getTime())}0!==t&&(u=setInterval(this.scrollUpdateText,t))}},self.goToNext=()=>{const e=c.next().value;if(!this.isFinishedParsing(e))return"TextResult"===e.constructor.name&&e.data&&this.node.title!==e.data.title&&(a="",h=-1,this.node=self.jsonCopy(e.data),this.visitedNodes.push(e.data.title),this.emiter.emit("startedNode",this.node)),e},this.isFinishedParsing=e=>(void 0===e||null===d)&&(i||(i=!0,h=-1),i=!0,i),this.runCommand=()=>{e.emit("commandCall",d.text),t.push(d.text),d=self.goToNext(),this.isFinishedParsing(d)||("TextResult"===d.constructor.name&&(a+="\n"+d.text,e.emit("textResult",d.text)),"OptionsResult"===d.constructor.name&&(h=-1))},this.scrollUpdateText=()=>{if(!this.isFinishedParsing(d))if(h<0)"CommandResult"===d.constructor.name&&this.runCommand();else if(h>a.length){if("TextResult"===d.constructor.name){if(d=self.goToNext(),this.isFinishedParsing(d))return;"CommandResult"===d.constructor.name?this.runCommand():("TextResult"===d.constructor.name||"OptionsResult"===d.constructor.name)&&(h=-1)}}else"TextResult"===d.constructor.name&&(h+=1,l=a.substring(0,h),self.updateVNHud())},self.updateVNHud=()=>{if("TextResult"===d.constructor.name){for(;l.lastIndexOf("[img]")>l.lastIndexOf("[/img]");)h+=1,l=a.substring(0,h);for(;l.lastIndexOf("[")>l.lastIndexOf("]");)h+=1,l=a.substring(0,h)}this.scrollTextStyle&&(document.getElementById(p).innerHTML=n.parse(l)+"<br>"),void 0!==o&&(this.scrollTextStyle||(document.getElementById(p).innerHTML=""),document.getElementById(p).appendChild(o))},this.terminate=()=>{try{let t=document.getElementById(p);t&&(t.innerHTML=""),t=document.getElementById(g),t&&(t.innerHTML=""),o=void 0,e.removeAllListeners(),this.finished=!0}catch(e){console.warn(e)}},this.initYarn=(t,o,r,a,l,d)=>{const c=["#f5ff6f","#44fe66","#e00ec0","#e93ecf","#0ec0e0","#3ecfe9","#e4dbcb","#978e7e","#666","#2f919a","deeppink","black","#97E1E9","#576574","#6EA5E0","#9EDE74","#FFE374","#F7A666","#C47862"],u=["__̴ı̴̴̡̡̡ ̡͌l̡̡̡ ̡͌l̡*̡̡ ̴̡ı̴̴̡ ̡̡͡| ̲▫̲͡ ̲̲͡▫̲̲͡͡ ̲|̡̡̡ ̡, ̴̡ı̴̡̡ ̡͌l̡̡̡̡.___","°º¤ø,¸¸,ø¤º°`°º¤ø,¸,ø¤°º¤ø,¸¸,ø¤º°`°º¤ø,¸","(===||:::::::::::::::>","¸.·´¯`·.´¯`·.¸¸.·´¯`·.¸><(((º>","=^..^=","|==|iiii|>-----"," ¦̵̱ ̵̱ ̵̱ ̵̱ ̵̱(̢ ̡͇̅└͇̅┘͇̅ (▤8כ−◦","(♥_♥)","龴ↀ◡ↀ龴","☁ ▅▒░☼‿☼░▒▅ ☁,","▓⚗_⚗▓","<:3 )~~~","(╯°□°）╯︵ ┻━┻","●▬▬▬▬๑۩۩๑▬▬▬▬▬●","(/)(Ö,,,,Ö)(/)","/)^3^(\\","( . Y . )","< )))) ><","(ノಠ益ಠ)ノ彡","d(^o^)b¸¸♬·¯·♩¸¸♪·¯·♫¸¸","O=('-'Q)","-`ღ´-","ˁ(⦿ᴥ⦿)ˀ","(╥﹏╥)","✲´*。.❄¨¯`*✲。❄。*。¨¯`*✲","▂▃▅▇█▓▒░۩۞۩        ۩۞۩░▒▓█▇▅▃▂","( •_•)O*¯`·.¸.·´¯`°Q(•_• )","┻━┻︵  (°□°)/ ︵ ┻━┻","|̲̲̲͡͡͡ ̲▫̲͡ ̲̲̲͡͡π̲̲͡͡ ̲̲͡▫̲̲͡͡ ̲|̡̡̡ ̡ ̴̡ı̴̡̡ ̡͌l̡ ̴̡ı̴̴̡ ̡l̡*̡̡ ̴̡ı̴̴̡ ̡̡͡|̲̲̲͡͡͡ ̲▫̲͡ ̲̲̲͡͡π̲̲͡͡ ̲̲͡▫̲̲͡͡ |","❤◦.¸¸.  ◦✿","ʕʘ̅͜ʘ̅ʔ","( ๏ Y ๏ )","ʕ•̫͡•ʕ*̫͡*ʕ•͓͡•ʔ-̫͡-ʕ•̫͡•ʔ*̫͡*ʔ-̫͡-ʔ","(っ◕‿◕)っ","❚█══█❚","─=≡Σ((( つ◕ل͜◕)つ","^ↀᴥↀ^","༼ つ ͡◕ Ѿ ͡◕ ༽つ","ᕦ(ò_óˇ)ᕤ","┬┴┬┴┤ ͜ʖ ͡°) ├┬┴┬┴","[̲̅$̲̅(̲̅5)̲̅$̲̅]","(ꈍ⌓ꈍ✿)","(๑•́ ₃ •̀๑) ♡","( • )( • )ԅ(≖⌣≖ԅ)","（。々°）","⊂(´･◡･⊂ )∘˚˳°","( ㅅ )","(ﾉ☉ヮ⚆)ﾉ ⌒*:･ﾟ✧","(－‸ლ)","(‿|‿)","(㇏(•̀ᵥᵥ•́)ノ)","ʚ✟⃛ɞ","(′ꈍωꈍ‵)","♚ ♛ ♜ ♝ ♞ ♟ ♔ ♕ ♖ ♗ ♘ ♙","(´ᴗ`)(´ᴗ`)","♥(´∀｀)","ฅ(˵●ﻌ●˵)ฅ"];g=l,p=r,this.yarnDataObject=t,this.startChapter=o,this.resourcesPath=a,this.finished=!1,this.scrollTextStyle="npc"===d,document.getElementById(g).innerHTML="<br/><font color='red'>🚥Press/Hold Z or 📱Double-click/Tap to advance</font><br/>",e.on("startedNode",(function(e){document.getElementById(g).innerHTML+="<br/><br/><font color='#581845'>📜 --- Loaded next node ---</font>",document.getElementById(g).innerHTML+=`<font color='${c[Math.floor(Math.random()*c.length)]}'>  ${u[Math.floor(Math.random()*u.length)]}</font>`,document.getElementById(g).innerHTML+="<br/><font color='CADETBLUE'>&ensp;&ensp;&ensp;Title: "+e.title+"</font>",e.tags.length>0&&e.tags[0].length>0&&(document.getElementById(g).innerHTML+="<br/><font color='deeppink'>&ensp;&ensp;&ensp;Tags: "+e.tags+"</font>")})),e.on("choiceMade",(function(e){this.scrollTextStyle?document.getElementById(g).innerHTML+="<br/><font color='fuchsia'>🐙Player chose: >"+e+"</font>":document.getElementById(g).innerHTML+=`<p class="story-playtest-bubble story-playtest-answer answer-post">${n.parse(e)}</p>`})),e.on("commandCall",(function(e){document.getElementById(g).innerHTML+=`<br/><font color='green'>🐣Command call:</font> <font color='red'>&lt;&lt;${e}&gt;&gt;</font>`})),this.scrollTextStyle||(e.on("textResult",(function(e){document.getElementById(g).innerHTML+=`<p class="story-playtest-bubble">${n.parse(e)}</p>`,document.getElementById(p).innerHTML='<span class="story-animated-dots"><p>.</p><p>.</p><p>.</p></span>',document.getElementById(p).className="story-playtest-bubble",document.getElementById(g).scrollTo({top:document.getElementById(g).scrollHeight,left:0,behavior:"smooth"})})),e.on("choiceUpdated",(function(e){document.getElementById(p).className="story-playtest-answer"}))),e.on("finished",(function(){i=!0,e.removeAllListeners()})),s.load(t),this.loadYarnChapter(o)},this.loadYarnChapter=e=>{i=!1,this.storyChapter=e,this.choices[this.storyChapter]=[],this.visitedChapters.push(e),c=s.run(e),d=self.goToNext(),a=d.text,this.changeTextScrollSpeed(100)},this.wasChoiceMade=(e,t=this.storyChapter)=>!!this.choices[t].includes(e),this.timesNodeWasVisited=e=>{let t=0;return this.visitedNodes.forEach((i,o)=>{i===e&&(t+=1)}),t},self.jsonCopy=e=>JSON.parse(JSON.stringify(e))}},Q0t6:function(e,t){function i(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}i.keys=function(){return[]},i.resolve=i,e.exports=i,i.id="Q0t6"},W2Rx:function(e,t,i){"use strict";(function(e,o){i.d(t,"a",(function(){return r}));var n=i("oj90");let s=0;let r=function(t={}){const i=this;this.titleStyles=["title-style-1","title-style-2","title-style-3","title-style-4","title-style-5","title-style-6","title-style-7","title-style-8","title-style-9"],this.index=e.observable(s++),this.title=e.observable(t.title||app.getUniqueTitle()),this.tags=e.observable(t.tags||""),this.body=e.observable(t.body||"Empty Text"),this.active=e.observable(t.active||!0),this.width=200,this.height=200,this.tempOpacity=null,this.style=null,this.colorID=e.observable(t.colorID||0),this.checked=!1,this.selected=!1,this.createX=isNaN(t.x)?null:t.x,this.createY=isNaN(t.y)?null:t.y,this.undoManager=null,this.clippedTags=e.computed((function(){return app.updateTagsRepository(),n.Utils.uniqueSplit(i.tags()," ").map(e=>app.tags().find(t=>t.text===e)).filter(e=>e)}),this),this.clippedBody=e.computed((function(){if(app.ui.isScreenNarrow()&&app.editing())return;app.mustRefreshNodes();let e=app.getHighlightedText(this.body());return e=app.richTextFormatter.richTextToHtml(e),e}),this),this.linkedTo=e.observableArray(),this.linkedFrom=e.observableArray(),this.element=null,this.canDoubleClick=!0,this.create=function(){if(i.style=window.getComputedStyle(o(i.element).get(0)),null!==i.createX)i.x(i.createX);else{let e=o(i.element).parent();i.x(-e.offset().left+o(window).width()/2-100)}if(null!==i.createY)i.y(i.createY);else{let e=o(i.element).parent();i.y(-e.offset().top+o(window).height()/2-100)}app.workspace.bringToFront(i.element),app.workspace.startUpdatingArrows(),o(i.element).css({opacity:0,scale:.8,y:"-=80px",rotate:"45deg"}).transition({opacity:1,scale:1,y:"+=80px",rotate:"0deg"},250,"easeInQuad",(function(){app.workspace.stopUpdatingArrows(),app.workspace.updateArrows()})),i.drag(),o(i.element).on("dblclick",(function(){i.canDoubleClick&&app.editNode(i)})),n.Utils.addDoubleTapDetector(i.element,(function(){i.canDoubleClick&&app.editNode(i)})),o(i.element).on("click",(function(e){e.ctrlKey&&(i.selected?app.workspace.deselectNodes(i):app.workspace.selectNodes(i))}))},this.setSelected=function(e){i.selected=e,i.selected?o(i.element).addClass("selected"):o(i.element).removeClass("selected")},this.toggleSelected=function(){i.setSelected(!i.selected)},this.x=function(e){if(null!=e&&o(i.element).css({x:Math.floor(e)}),i.style)return Math.floor(new WebKitCSSMatrix(i.style.webkitTransform).m41)},this.y=function(e){if(null!=e&&o(i.element).css({y:Math.floor(e)}),i.style)return Math.floor(new WebKitCSSMatrix(i.style.webkitTransform).m42)},this.resetDoubleClick=function(){i.canDoubleClick=!0},this.cycleColorDown=function(){i.doCycleColorDown(),setTimeout(i.resetDoubleClick,500),i.canDoubleClick=!1,app.input.isShiftDown&&app.matchConnectedColorID(i),i.selected&&app.setSelectedColors(i),app.setYarnDocumentIsDirty()},this.cycleColorUp=function(){i.doCycleColorUp(),setTimeout(i.resetDoubleClick,500),i.canDoubleClick=!1,app.input.isShiftDown&&app.matchConnectedColorID(i),i.selected&&app.setSelectedColors(i),app.setYarnDocumentIsDirty()},this.doCycleColorDown=function(){i.colorID(i.colorID()-1),i.colorID()<0&&i.colorID(8)},this.doCycleColorUp=function(){i.colorID(i.colorID()+1),i.colorID()>8&&i.colorID(0)},this.remove=async function(){return new Promise((e,t)=>{o(i.element).transition({opacity:0,scale:.8,y:"-=80px",rotate:"-45deg"},250,"easeInQuad",e)})},this.drag=function(){const e={x:0,y:0};let t=!1,n=!1;o(document.body).on("mousemove touchmove",(function(o){if(t){const t=app.input.isScreenTouched&&o.changedTouches?o.changedTouches[0].pageX:o.pageX,s=app.input.isScreenTouched&&o.changedTouches?o.changedTouches[0].pageY:o.pageY;let{x:r,y:a}=app.workspace.toWorkspaceCoordinates(t,s);r-=e.x,a-=e.y;let l=r-i.x(),d=a-i.y();const c=app.workspace.getSelectedNodes();if(("mousemove"===o.originalEvent.type||c.includes(i)&&"touchmove"===o.originalEvent.type)&&(i.x(r),i.y(a)),n&&(i.selected?c.splice(c.indexOf(i),1):c=app.getNodesConnectedTo(i),c.length>0))for(let e in c)c[e].active()&&(c[e].x(c[e].x()+l),c[e].y(c[e].y()+d));app.workspace.updateArrows()}})),o(i.element).on("pointerdown",(function(o){if(!t&&i.active()&&0===o.button){t=!0,(app.input.isShiftDown||i.selected)&&(n=!0);const{x:s,y:r}=app.workspace.toWorkspaceCoordinates(o.pageX,o.pageY);e.x=app.settings.snapGridEnabled()?app.workspace.stepify(s-i.x(),app.settings.gridSize()):s-i.x(),e.y=app.settings.snapGridEnabled()?app.workspace.stepify(r-i.y(),app.settings.gridSize()):r-i.y()}})),o(i.element).on("touchend",(function(e){app.workspace.selectNodes(i)})),o(document).on("pointerup touchend",(function(){(t||n)&&(t=!1,n=!1,app.setYarnDocumentIsDirty())}))},this.moveTo=function(e,t){app.workspace.startUpdatingArrows(),o(i.element).clearQueue(),o(i.element).transition({x:e,y:t},app.stopUpdatingArrows,500)},this.isConnectedTo=function(e,t){if(t&&e.isConnectedTo(i,!1))return!0;let o=i.linkedTo();for(let t in o){if(o[t]==e)return!0;if(o[t].isConnectedTo(e,!1))return!0;if(e.isConnectedTo(o[t],!1))return!0}return!1},this.getLinksInNode=function(e){let t=[...(e||i).body().matchAll(/(?:\<\<jump)\s+(.*)(?=\>\>)/g)];if(Array.isArray(t)||!t.length){let e=[];return t.forEach(t=>{e.push(t[1])}),e}},this.updateLinks=function(){i.resetDoubleClick(),i.updateLinksFromParents(),i.updateLinksToChildren()},this.updateLinksFromParents=function(){i.oldTitle&&i.oldTitle!==i.title()&&(i.linkedFrom.removeAll(),app.nodes().forEach(e=>{const t=i.getLinksInNode(e);if(t)if(t.includes(i.oldTitle)){const t=RegExp("<<jump\\s+"+i.oldTitle+"\\s*>>","g"),o=e.body().replace(t,"<<jump "+i.title()+">>");e.body(o),i.linkedFrom.push(e)}else t.includes(i.title())&&i.linkedFrom.push(e)}),i.oldTitle=void 0)},this.updateLinksToChildren=function(){i.linkedTo.removeAll();let e=i.getLinksInNode();if(e)for(let t in app.nodes()){let o=app.nodes()[t];for(let t=0;t<e.length;t++)o!=i&&o.title().trim()===e[t].trim()&&i.linkedTo.push(o)}}};e.bindingHandlers.nodeBind={init:function(e,t,i,o,n){n.$rawData.element=e,n.$rawData.create()},update:function(e,t,i,n,s){o(e).on("pointerdown",(function(){app.workspace.bringToFront(e)}))}}}).call(this,i("kzO7"),i("EVdn"))},e6Wu:function(e,t,i){"use strict";i.r(t);i("hZTp");var o=i("oj90"),n=i("aPtq"),s=i.n(n),r=(i("5uVa"),i("si6p"),i("ghrA"),i("bU/s")),a=i.n(r),l=(i("A8C4"),i("VEX6"),i("jF1P"),i("YhK8"),i("Ab/9"),i("KDOe"),i("XfCI"),i("PSD3")),d=i.n(l),c=i("P0sH"),u=i("pLxK");window.ko=s.a,window.$=window.jQuery=i("EVdn"),window.ace=a.a,a.a.config.set("basePath",o.Utils.getPublicPath()),window.define=a.a.define,window.Swal=d.a,"serviceWorker"in navigator&&window.addEventListener("load",()=>{navigator.serviceWorker.register("sw.js").then(e=>{console.log("SW registered: ",e)}).catch(e=>{console.log("SW registration failed: ",e)})}),window.app=new c.a("Crochet","v"+u.a+" ALPHA"),window.app.run(),s.a.options.foreachHidesDestroyed=!0},fkuv:function(e,t,i){"use strict";(function(e,o){i.d(t,"a",(function(){return r}));var n=i("PSD3"),s=i.n(n);const r=function(t){const i=this;this.notification=s.a.mixin({toast:!0,position:"top",showConfirmButton:!1,timer:2500}),this.settingsDialogVisible=e.observable(!1),this.fileTagsDialogVisible=e.observable(!1),this.narrowScreenThreshold=600,this.isScreenNarrow=function(){return o(window).width()<=i.narrowScreenThreshold},this.availableMarkupLanguages=[{id:"bbcode",name:"Bbcode"},{id:"html",name:"Html"}],this.availableThemes=[{id:"classic",name:"Classic"},{id:"blueprint",name:"Blueprint"},{id:"dracula",name:"Dracula"}],this.availableFontSizes=[{id:"12px",name:"12px"},{id:"14px",name:"14px (Default)"},{id:"16px",name:"16px"},{id:"18px",name:"18px"},{id:"20px",name:"20px"},{id:"22px",name:"22px"},{id:"24px",name:"24px"}],this.availablePlaytestStyles=[{id:"npc",name:"Npc bubble"},{id:"chat",name:"Chat messages"}],this.availableLanguages=[{name:"Čeština",id:"cs-CZ"},{name:"Deutsch",id:"de-DE"},{name:"English",id:"en-GB"},{name:"Español",id:"es-ES"},{name:"Français",id:"fr-FR"},{name:"Nederlands",id:"nl-NL"},{name:"Norsk bokmål",id:"nb-NO"},{name:"Polski",id:"pl-PL"},{name:"Română",id:"ro-RO"},{name:"Slovenčina",id:"sk-SK"},{name:"Svenska",id:"sv-SE"},{name:"Türkçe",id:"tr-TR"},{name:"български",id:"bg-BG"},{name:"Pусский",id:"ru-RU"},{name:"Српски",id:"sr-RS"},{name:"한국어",id:"ko-KR"}],this.availableLineStyles=[{id:"straight",name:"Straight Lines"},{id:"bezier",name:"Bezier Curves"}],this.openSettingsDialog=function(){null!==t.editing()&&t.closeEditor(),i.settingsDialogVisible(!0),o(".settings-dialog").css({opacity:0}).transition({opacity:1},250),o(".settings-dialog .form").css({y:"-100"}).transition({y:"0"},250)},this.closeSettingsDialog=function(){o(".settings-dialog").css({opacity:1}).transition({opacity:0},250,e=>{i.settingsDialogVisible(!1)}),o(".settings-dialog .form").css({y:"0"}).transition({y:"-100"},250),setTimeout(()=>t.settings.apply(),100)},this.openFileTagsDialog=function(){s.a.fire({input:"textarea",width:"80%",heightAuto:!1,title:"Enter File Tags",customClass:{input:"fileTagsInput"},inputPlaceholder:"#tag_name: tag_content",inputValue:i.convertFileTagsToString(),allowOutsideClick:!1,allowEnterKey:!1,allowEscapeKey:!1,confirmButtonText:"Save",showCancelButton:!0,focusConfirm:!1,inputValidator:e=>new Promise(t=>{let i=e.match(/^.*((\r\n|\n|\r)|$)/gm),o=[];i.forEach((e,n)=>{if(0===e.length||"\n"===e){if(1!==i.length)return;t()}else if("#"!==e.charAt(0))t("ERROR ON LINE "+n+"</br>"+e+'</br>File tags need to begin with a "#"');else if(e.length<=1)t("ERROR ON LINE "+n+"</br>"+e+"</br>File tag names need to be longer than 0 characters.");else{let i=e.slice(1);o.includes(i)?t("ERROR ON LINE "+n+"</br>"+e+"</br>Duplicate tag detected"):o.push(i)}}),t()})}).then(e=>{e.value&&(t.data.clearFileTags(),t.data.saveFileTags(e.value),i.notification.fire({icon:"success",title:"File Tags Validated!"}))})},this.convertFileTagsToString=function(){let e="";return t.fileTags.forEach(t=>{e+="#"+t+"\n"}),e},this.isDialogOpen=function(){return i.settingsDialogVisible()||i.fileTagsDialogVisible()||s.a.isVisible()&&!s.a.isTimerRunning()},this.setEditorFontSize=function(){null!==t.editor&&t.editor.setOptions({fontSize:t.settings.editorFontSize()})},this.confirmMarkupConversion=function(){s.a.fire({title:"Are you sure?",text:"Markup on all nodes will be modified. This can rarely result in broken texts. This operation can't be undone.",icon:"warning",showCancelButton:!0,confirmButtonText:"Yes, convert it!",cancelButtonText:"No, cancel!",reverseButtons:!0}).then(e=>{e.value&&(t.convertMarkup(),s.a.fire("Converted!","The markup on the nodes has been converted.","success"))})},this.openNodeListMenu=function(e){const i="jump"===e?document.getElementById("jumpHelperMenuFilter").value.toLowerCase():document.getElementById("nodeSearchInput").value.toLowerCase(),n=document.getElementById(e+"HelperMenu");n.innerHTML="",t.nodes().forEach((s,r)=>{if(s.title().toLowerCase().indexOf(i)>=0||0==i.length){const a=document.createElement("span");a.innerHTML=s.title(),o(a).addClass("item "+t.nodes()[r].titleStyles[t.nodes()[r].colorID()]),"jump"==e?s.title()!==t.editing().title()&&(a.setAttribute("onclick","app.insertTextAtCursor('<<jump "+s.title()+">>')"),n.appendChild(a)):"open"==e&&(s.title().toLowerCase().indexOf(i)>=0||0==i.length)&&(a.setAttribute("onclick",`app.openNodeByTitle("${s.title()}")`),a.setAttribute("onmouseenter",`app.workspace.warpToNodeByIdx(${t.nodes.indexOf(s)})`),n.appendChild(a))}})},this.checkAndMoveAppButtons=function(){o(".app-add-node").toggleClass("app-add-node-alt","right"===t.settings.editorSplitDirection()),o(".app-sort").toggleClass("app-sort-alt","right"===t.settings.editorSplitDirection()),o(".app-undo-redo").toggleClass("app-undo-redo-alt","right"===t.settings.editorSplitDirection()),o(".app-zoom").toggleClass("app-zoom-alt","right"===t.settings.editorSplitDirection())},this.resetAppButtonsLocation=function(){o(".app-add-node").removeClass("app-add-node-alt"),o(".app-sort").removeClass("app-sort-alt"),o(".app-undo-redo").removeClass("app-undo-redo-alt"),o(".app-zoom").removeClass("app-zoom-alt")}}}).call(this,i("kzO7"),i("EVdn"))},hZTp:function(e,t,i){},jF1P:function(e,t,i){(function(e){var t,i;t={},i=0,e.bindingHandlers.ace={init:function(o,n,s,r,a){var l=s().aceOptions||{},d=e.utils.unwrapObservable(n());o.id||(o.id="knockout-ace-"+i,i+=1);var c=ace.edit(o.id);l.theme&&c.setTheme("ace/theme/"+l.theme),l.mode&&c.getSession().setMode("ace/mode/"+l.mode),c.setValue(d),c.gotoLine(0),c.setShowPrintMargin(!1),c.getSession().setUseWrapMode(!0),c.getSession().on("change",(function(t){e.isWriteableObservable(n())&&n()(c.getValue())})),t[o.id]=c,e.utils.domNodeDisposal.addDisposeCallback(o,(function(){try{c.destroy()}catch(e){}delete t[o.id]}))},update:function(i,o,n,s,r){var a=e.utils.unwrapObservable(o()),l=i.id;if(void 0!==l&&""!==l&&t.hasOwnProperty(l)){var d=t[l];d.getValue()!==a&&(d.setValue(a),d.gotoLine(0))}}},e.aceEditors={resizeAll:function(){for(var e in t)t.hasOwnProperty(e)&&t[e].resize()},get:function(e){return t[e]}}}).call(this,i("kzO7"))},"l8+o":function(e,t,i){"use strict";i.d(t,"a",(function(){return s}));var o=i("mIo7"),n=i("mqgS");const s=function(e){return"html"===e.settings.markupLanguage()?new n.a(e):new o.a(e)}},mIo7:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return BbcodeRichTextFormatter}));const bbcode=__webpack_require__("L8pc"),BbcodeRichTextFormatter=function(app){const self=this;this.justInsertedAutoComplete=!1,this.completableTags=Object.freeze([{Start:"<<",Completion:">>",Offset:-2},{Start:"[colo",Completion:"r=#][/color]",Offset:-9,BehaviorCompletion:"r=#][/color",Func:()=>{app.insertColorCode()}},{Start:"[b",Completion:"][/b]",BehaviorCompletion:"][/b",Offset:-4},{Start:"[i",Completion:"][/i]",BehaviorCompletion:"][/i",Offset:-4},{Start:"[img",Completion:"][/img]",BehaviorCompletion:"][/img",Offset:-6},{Start:"[u",Completion:"][/u]",BehaviorCompletion:"][/u",Offset:-4},{Start:"[url",Completion:"][/url]",BehaviorCompletion:"][/url",Offset:-6}]),this.getTagOpen=function(e){switch(e){case"cmd":return"<<";case"opt":return"[[";case"color":return"[color=#]";default:return`[${e}]`}},this.getTagClose=function(e){switch(e){case"cmd":return">>";case"opt":return"|]]";default:return`[/${e}]`}},this.identifyTag=function(e){let t=-1!==e.lastIndexOf("[")?e.substring(e.lastIndexOf("["),e.length):"";return"[["===e.substring(e.length-2,e.length)?t="[[":"<<"===e.substring(e.length-2,e.length)&&(t="<<"),t},this.insertTag=function(e){const t=self.getTagOpen(e),i=self.getTagClose(e),o=JSON.parse(JSON.stringify(app.editor.selection.getRange()));app.editor.session.insert(o.start,t),app.editor.session.insert({column:o.end.column+t.length,row:o.end.row},i),"color"===e&&(0===app.editor.getSelectedText().length?app.moveEditCursor(-9):app.editor.selection.setRange({start:{row:app.editor.selection.getRange().start.row,column:app.editor.selection.getRange().start.column-1},end:{row:app.editor.selection.getRange().start.row,column:app.editor.selection.getRange().start.column-1}}),app.insertColorCode()),"img"===e?0===app.editor.getSelectedText().length&&(app.moveEditCursor(-6),app.data.triggerPasteClipboard(),setTimeout(()=>app.moveEditCursor(6),300)):0===app.editor.getSelectedText().length?app.isEditorInPreviewMode||app.moveEditCursor(-i.length):app.editor.selection.setRange({start:app.editor.selection.getRange().start,end:{row:app.editor.selection.getRange().end.row,column:app.editor.selection.getRange().end.column-i.length}}),app.editor.focus()},this._convertTag=function(inPattern,outPattern,text){const globalRegex=new RegExp(inPattern,"gi"),localRegex=new RegExp(inPattern,"i");return text.replace(globalRegex,m=>{const match=m.match(localRegex),template=eval("`"+outPattern+"`");return match.length?template:null})},this.convert=function(e){let t=e;return t=self._convertTag("<b>(.*?)<\\/b>","[b]${match[1]}[/b]",t),t=self._convertTag("<u>(.*?)<\\/u>","[u]${match[1]}[/u]",t),t=self._convertTag("<i>(.*?)<\\/i>","[i]${match[1]}[/i]",t),t=self._convertTag("<img>(.*?)<\\/img>","[img]${match[1]}[/img]",t),t=self._convertTag("<color=#(.*?)>(.*?)<\\/color>","[color=#${match[1]}]${match[2]}[/color]",t),t=self._convertTag("<url>(.*?)<\\/url>","[url]${match[1]}[/url]",t),t},this.richTextToHtml=function(e,t=!1){let i=1,o=t?'<div><font color="pink">'+i+". </font><font>"+e+"</font></div>":e;if(o=o.replace(/<</gi,"<font color='violet'>(run:"),o=o.replace(/>>/gi,")</font>"),o=o.replace(/\[color=#[A-Za-z0-9]+\]/gi,(function(e){const t=e.match(/\[color=#([A-Za-z0-9]+)\]/i);if(t&&t.length>1)return"[color=#"+t[1]+"]<font color=#"+t[1]+">&#9751</font>"})),o=o.replace(/\[img\][^\[]+\[\/img\]/gi,(function(e){const i=e.match(/\[img\](.*)\[\/img\]/i);if(i.length>1){const e=app.data.editingFileFolder(i[1]);return app.data.doesFileExist(e)?t?'<img src="'+e+'"> </img>':'<img src="'+e+'" width="128" height="auto"> </img>':t?'<img src="'+i[1]+'"> </img>':'<img src="'+i[1]+'" width="128" height="auto"> </img>'}})),o=o.replace(/[\n\r]/g,(function(e){let o="</font><br/>";return i+=1,t&&(o+='</div><div><font color="pink">'+i+". </font><font>"),o})),o=bbcode.parse(o),t){const e=[];o=o.replace(/(https?:\/\/twitter.com\/[^\s\<]+\/[^\s\<]+\/[^\s\<]+)/gi,(function(t){const i=t.match(/https:\/\/twitter.com\/.*\/status\/([0-9]+)/i);if(i.length>1)return e.push(i[1]),`<a class="tweet" id="${i[1]}"></a>`})),setTimeout(()=>{const t=document.querySelectorAll(".tweet");e.forEach((e,i)=>{twttr.widgets.createTweet(e,t[i],{align:"center",follow:!1})})},500)}return o}}},mqgS:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return HtmlRichTextFormatter}));const HtmlRichTextFormatter=function(app){const self=this;this.justInsertedAutoComplete=!1,this.completableTags=Object.freeze([{Start:"<<",Completion:">>",Offset:-2},{Start:"<colo",Completion:"r=#></color>",Offset:-9,Func:()=>{app.insertColorCode()}},{Start:"<b",Completion:"></b>",Offset:-4},{Start:"<img",Completion:"></img>",Offset:-6},{Start:"<i",Completion:"></i>",Offset:-4},{Start:"<u",Completion:"></u>",Offset:-4},{Start:"<url",Completion:"></url>",Offset:-6}]),this.getTagOpen=function(e){switch(e){case"cmd":return"<<";case"opt":return"[[";case"color":return"<color=#>";default:return`<${e}>`}},this.getTagClose=function(e){switch(e){case"cmd":return">>";case"opt":return"|]]";default:return`</${e}>`}},this.identifyTag=function(e){let t=-1!==e.lastIndexOf("<")?e.substring(e.lastIndexOf("<"),e.length):"";return"[["===e.substring(e.length-2,e.length)?t="[[":"<<"===e.substring(e.length-2,e.length)&&(t="<<"),t},this.insertTag=function(e){const t=self.getTagOpen(e),i=self.getTagClose(e),o=JSON.parse(JSON.stringify(app.editor.selection.getRange()));app.editor.session.insert(o.start,t),app.editor.session.insert({column:o.end.column+t.length,row:o.end.row},i),"color"===e&&(0===app.editor.getSelectedText().length?app.moveEditCursor(-9):app.editor.selection.setRange({start:{row:app.editor.selection.getRange().start.row,column:app.editor.selection.getRange().start.column-1},end:{row:app.editor.selection.getRange().start.row,column:app.editor.selection.getRange().start.column-1}}),app.insertColorCode()),"img"===e?navigator.clipboard.readText().then(e=>{0===app.editor.getSelectedText().length&&(app.moveEditCursor(-7),app.insertTextAtCursor(` src="${e}"`))}):0===app.editor.getSelectedText().length?app.isEditorInPreviewMode||app.moveEditCursor(-i.length):app.editor.selection.setRange({start:app.editor.selection.getRange().start,end:{row:app.editor.selection.getRange().end.row,column:app.editor.selection.getRange().end.column-i.length}}),app.editor.focus()},this._convertTag=function(inPattern,outPattern,text){const globalRegex=new RegExp(inPattern,"gi"),localRegex=new RegExp(inPattern,"i");return text.replace(globalRegex,m=>{const match=m.match(localRegex),template=eval("`"+outPattern+"`");return match.length?template:null})},this.convert=function(e){let t=e;return t=self._convertTag("\\[b\\](.*?)\\[\\/b\\]","<b>${match[1]}</b>",t),t=self._convertTag("\\[u\\](.*?)\\[\\/u\\]","<u>${match[1]}</u>",t),t=self._convertTag("\\[i\\](.*?)\\[\\/i\\]","<i>${match[1]}</i>",t),t=self._convertTag("\\[img\\](.*?)\\[\\/img\\]","<img>${match[1]}</img>",t),t=self._convertTag("\\[color=#(.*?)\\](.*?)\\[\\/color\\]","<color=#${match[1]}>${match[2]}</color>",t),t=self._convertTag("\\[url\\](.*?)\\[\\/url\\]","<url>${match[1]}</url>",t),t},this.richTextToHtml=function(e,t=!1){let i=1,o=t?'<div><font color="pink">'+i+". </font><font>"+e+"</font></div>":e;if(o=o.replace(/<</gi,"<font color='violet'>(run:"),o=o.replace(/>>/gi,")</font>"),[/&lt;color=#(.*?)&gt;(.*?)&lt;\/color&gt;/,/<color=#(.*?)>(.*?)<\/color>/].forEach(e=>{const t=new RegExp(e,"gi"),i=new RegExp(e,"i");o=o.replace(t,(function(e){const t=e.match(i);if(t&&t.length>2)return`<font color=#${t[1]}>&#9751${t[2]}</font>`}))}),o=o.replace(/&lt;img&gt;[^\[]+&lt;\/img&gt;/gi,(function(e){const i=e.match(/&lt;img&gt;(.*?)&lt;\/img&gt;/i);if(i.length>1){const e=app.data.editingFileFolder(i[1]);return app.data.doesFileExist(e)?t?'<img src="'+e+'"> </img>':'<img src="'+e+'" width="128" height="auto"> </img>':t?'<img src="'+i[1]+'"> </img>':'<img src="'+i[1]+'" width="128" height="auto"> </img>'}})),o=o.replace(/&lt;b&gt;.*&lt;\/b&gt;/gi,e=>{const t=e.match(/&lt;b&gt;(.*)&lt;\/b&gt;/i);if(t.length)return`<b>${t[1]}</b>`}),o=o.replace(/&lt;u&gt;.*&lt;\/u&gt;/gi,e=>{const t=e.match(/&lt;u&gt;(.*)&lt;\/u&gt;/i);if(t.length)return`<u>${t[1]}</u>`}),o=o.replace(/&lt;i&gt;.*&lt;\/i&gt;/gi,e=>{const t=e.match(/&lt;i&gt;(.*)&lt;\/i&gt;/i);if(t.length)return`<i>${t[1]}</i>`}),o=o.replace(/[\n\r]/g,(function(e){let o="</font><br/>";return i+=1,t&&(o+='</div><div><font color="pink">'+i+". </font><font>"),o})),t){const e=[];o=o.replace(/(https?:\/\/twitter.com\/[^\s\<]+\/[^\s\<]+\/[^\s\<]+)/gi,(function(t){const i=t.match(/https:\/\/twitter.com\/.*\/status\/([0-9]+)/i);if(i.length>1)return e.push(i[1]),`<a class="tweet" id="${i[1]}"></a>`})),setTimeout(()=>{const t=document.querySelectorAll(".tweet");e.forEach((e,i)=>{twttr.widgets.createTweet(e,t[i],{align:"center",follow:!1})})},500)}return o}}},oj90:function(e,t,i){"use strict";i.r(t),function(e){i.d(t,"FILETYPE",(function(){return o})),i.d(t,"Utils",(function(){return n}));var o={JSON:"json",XML:"xml",TWEE:"twee",TWEE2:"tw2",UNKNOWN:"none",YARN:"yarn"},n={createAutocompleter:function(e,t,i,o=1){return{getCompletions:function(n,s,r,a,l){var d=n.session.getTokenAt(r.row,r.column);a.length<o||!e.includes(d.type)?l(null,[]):l(null,t.map((function(e){return{caption:e,value:e,meta:i}})))}}},addDoubleTapDetector:function(e,t){e.lastTap=0,e.tapTimeout=0,e.addEventListener("touchend",(function(i){var o=(new Date).getTime(),n=o-e.lastTap;clearTimeout(e.tapTimeout),n<500&&n>0?(t(),i.preventDefault()):e.tapTimeout=setTimeout((function(){clearTimeout(e.tapTimeout)}),500),e.lastTap=o}))},uniqueSplit:function(e,t=" "){return[...new Set(e.split(t).filter(e=>e))]},getHighestZ:function(t){let i=Number.NEGATIVE_INFINITY;return e(t).children().each((function(){let t=parseInt(e(this).css("z-index"))||0;t>i&&(i=t)})),i},clamp:function(e,t,i){return Math.max(Math.min(e,i),t)},rectanglesOverlap:function(e,t){return!(t.left>e.right||t.right<e.left||t.top>e.bottom||t.bottom<e.top)},stripHtml:function(e){for(;e.indexOf("<")>=0;)e=e.replace("<","&lt;");for(;e.indexOf(">")>=0;)e=e.replace(">","&gt");return e},xmlToObject:function(e){var t=[];if((e=e.childNodes.item(0)).hasChildNodes())for(var i=0;i<e.childNodes.length;i++){var o=e.childNodes.item(i);if(o.hasChildNodes()){for(var n={},s=!1,r=0;r<o.childNodes.length;r++){var a=o.childNodes.item(r);if("#text"!=a.nodeName&&(s=!0,a.hasChildNodes()?n[a.nodeName]=a.childNodes.item(0).nodeValue:n[a.nodeName]="",a.attributes.length>0)){n[a.nodeName]={};for(var l=0;l<a.attributes.length;l++){var d=a.attributes.item(l);n[a.nodeName][d.nodeName]=d.nodeValue}}}s&&t.push(n)}}return t},now:Date.now||function(){return(new Date).getTime()},getPublicPath:function(e){return window.getPublicVsCodeWebviewUri?window.getPublicVsCodeWebviewUri(e):"public"+(e?"/"+e:"")}}}.call(this,i("EVdn"))},owJe:function(e,t,i){(function(e){var o=i("jXEy"),n=i("oj90"),s=n.Utils.getPublicPath("dictionaries/en/index.dic"),r=n.Utils.getPublicPath("dictionaries/en/index.aff");e("<style type='text/css'>.ace_marker-layer .misspelled { position: absolute; z-index: -2; border-bottom: 1px solid red; margin-bottom: -1px; }</style>").appendTo("head"),e("<style type='text/css'>.misspelled { border-bottom: 1px solid red; margin-bottom: -1px; }</style>").appendTo("head");var a=null;function l(e){var t=e.split(/\s+|\.|\,|\?|\\|\/|\!|\[|\]|"|'|;|:|`|\+|\-|\&|\$|@|~|#|>|<|_|\)|\(|£|\^|%|\*|„|“|\||[0-9]+/g),i=0,o=[];for(word in t){var n=t[word];a.correct(n)||(o[o.length]=[i,i+t[word].length]),i+=t[word].length+1}return o}t.load_dictionary=function(t){console.info(`Loading ${t} hunspell dictionary locally`),s=n.Utils.getPublicPath(`dictionaries/${t}/index.dic`),r=n.Utils.getPublicPath(`dictionaries/${t}/index.aff`),Swal.close(),Swal.fire({title:"Loading Language...",text:"Please Wait",allowOutsideClick:!1,allowEnterKey:!1,backdrop:!0}),Swal.showLoading(),setTimeout(()=>{e.get(s,(function(e){dicData=e})).done((function(){e.get(r,(function(e){affData=e})).done((function(){a=new o(affData,dicData),console.log("Dictionary loaded locally"),Swal.close(),app.ui.notification.fire({title:"Language Loaded!",icon:"success"}),d=!0,null!==app.editing()&&app.settings.spellcheckEnabled()&&p()}))}))},100)},t.misspelled=l;var d=!0,c=!1,u=[];function p(){if(null!=a&&!c&&d){c=!0;var e=ace.edit("editor").getSession();h();try{var t=ace.require("ace/range").Range,i=e.getDocument().getAllLines();for(var o in i){var n=l(i[o]);for(var s in n){var r=new t(o,n[s][0],o,n[s][1]);u[u.length]=e.addMarker(r,"misspelled","typo",!0)}}}finally{c=!1,d=!1}}}t.spell_check=p;var g=!1;function h(){var e=ace.edit("editor").getSession();for(var t in u)e.removeMarker(u[t]);u=[];var i=e.getDocument().getAllLines();for(var t in i)e.removeGutterDecoration(t,"misspelled")}t.enable_spellcheck=function(){g=!0,ace.edit("editor").getSession().on("change",(function(e){g&&(d=!0,p())})),d=!0,p()},t.disable_spellcheck=function(){g=!1,h()},t.clear_spellcheck_markers=h,t.suggest_word_for_misspelled=function(e){var t=a.suggest(e);return 0!==t.length&&t}}).call(this,i("EVdn"))},pLxK:function(e){e.exports=JSON.parse('{"a":"0.1.6"}')},pYPP:function(e,t,i){"use strict";(function(e){i.d(t,"a",(function(){return o}));const o=function(t){const i=this,o=window.vsCodeApi?{getItem:()=>{},setItem:()=>{}}:window.localStorage;this.storage=o,e.extenders.persist=function(e,t){return e.subscribe((function(e){o.setItem(t,e)})),e},this.apply=function(){t.setTheme(i.theme()),t.toggleInvertColors(),t.setMarkupLanguage(i.markupLanguage()),t.workspace.setThrottle(i.redrawThrottle()),t.setGistCredentials({token:i.gistToken(),file:null!==i.gistFile()?i.gistFile().split("/").pop():null})},this.validateGridSize=function(){i.gridSize()<20&&i.gridSize(20),i.gridSize()>200&&i.gridSize(200),i.gridSize(parseInt(i.gridSize())),t.initGrid()},this.theme=e.observable(o.getItem("theme")||"classic").extend({persist:"theme"}),this.editorFontSize=e.observable(o.getItem("editorFontSize")||"14px").extend({persist:"editorFontSize"}),this.spellCheckLanguage=e.observable(o.getItem("spellCheckLanguage")||"en-GB").extend({persist:"spellCheckLanguage"}),this.redrawThrottle=e.observable(parseInt(o.getItem("redrawThrottle")||"50")).extend({persist:"redrawThrottle"}),this.gistToken=e.observable(o.getItem("gistToken")).extend({persist:"gistToken"}),this.gistFile=e.observable(o.getItem("gistFile")).extend({persist:"gistFile"}),this.spellcheckEnabled=e.observable(null===o.getItem("spellcheckEnabled")||"true"===o.getItem("spellcheckEnabled")).extend({persist:"spellcheckEnabled"}),this.transcribeEnabled=e.observable(!1),this.autoCloseTags=e.observable(null===o.getItem("autoCloseTags")||"true"===o.getItem("autoCloseTags")).extend({persist:"autoCloseTags"}),this.autocompleteSuggestionsEnabled=e.observable(null===o.getItem("autocompleteSuggestionsEnabled")||"true"===o.getItem("autocompleteSuggestionsEnabled")).extend({persist:"autocompleteSuggestionsEnabled"}),this.autoCloseBrackets=e.observable(null===o.getItem("autoCloseBrackets")||"true"===o.getItem("autoCloseBrackets")).extend({persist:"autoCloseBrackets"}),this.invertColorsEnabled=e.observable(null!==o.getItem("invertColorsEnabled")&&"true"===o.getItem("invertColorsEnabled")).extend({persist:"invertColorsEnabled"}),this.snapGridEnabled=e.observable(null!==o.getItem("snapGridEnabled")&&"true"===o.getItem("snapGridEnabled")).extend({persist:"snapGridEnabled"}),this.gridSize=e.observable(parseInt(o.getItem("gridSize")||"40")).extend({persist:"gridSize"}),this.createNodesEnabled=e.observable(null===o.getItem("createNodesEnabled")||"true"===o.getItem("createNodesEnabled")).extend({persist:"createNodesEnabled"}),this.editorStatsEnabled=e.observable(null!==o.getItem("editorStatsEnabled")&&"true"===o.getItem("editorStatsEnabled")).extend({persist:"editorStatsEnabled"}),this.markupLanguage=e.observable(o.getItem("markupLanguage")||"bbcode").extend({persist:"markupLanguage"}),this.playtestStyle=e.observable(o.getItem("playtestStyle")||"chat").extend({persist:"playtestStyle"}),this.lineStyle=e.observable(o.getItem("lineStyle")||"straight").extend({persist:"lineStyle"}),this.rightClickNodeCreation=e.observable(null===o.getItem("rightClickNodeCreation")||"true"===o.getItem("rightClickNodeCreation")).extend({persist:"rightClickNodeCreation"}),this.alwaysOpenNodesInVisualStudioCodeEditor=e.observable(null!==o.getItem("alwaysOpenNodesInVisualStudioCodeEditor")&&"true"===o.getItem("alwaysOpenNodesInVisualStudioCodeEditor")).extend({persist:"alwaysOpenNodesInVisualStudioCodeEditor"}),this.editorSplitDirection=e.observable(o.getItem("editorSplitDirection")||"left").extend({persist:"editorSplitDirection"}),this.editorSplit=e.observable(null!==o.getItem("editorSplit")&&"true"===o.getItem("editorSplit")).extend({persist:"editorSplit"}),this.editorSplitSize=e.observable(o.getItem("editorSplitSize")||"50%").extend({persist:"editorSplitSize"})}}).call(this,i("kzO7"))}},[["e6Wu",1,2]]]);